2026-01-05 05:28:56,998 - INFO - Results will be saved to: result-2048in_512out/aws-g6e-L40S/tp2-pp2-20260105_052856
2026-01-05 05:28:56,998 - INFO - üöÄ Launching roofline-tp2-pp2-2048in-512out...
2026-01-05 05:28:56,998 - INFO - YAML to run: roofline_benchmarks/roofline-tp2-pp2-2048in-512out.yaml
2026-01-05 05:28:56,999 - INFO - Running on cluster: roofline-tp2-pp2-2048in-512out
2026-01-05 05:28:58,282 - INFO - YAML to run: roofline_benchmarks/roofline-tp2-pp2-2048in-512out.yaml
2026-01-05 05:28:58,405 - INFO - Running on cluster: roofline-tp2-pp2-2048in-512out
2026-01-05 05:28:59,676 - INFO - Considered resources (1 node):
2026-01-05 05:28:59,677 - INFO - ---------------------------------------------------------------------------------
2026-01-05 05:28:59,677 - INFO -  INFRA             INSTANCE       vCPUs   Mem(GB)   GPUS     COST ($)   CHOSEN
2026-01-05 05:28:59,677 - INFO - ---------------------------------------------------------------------------------
2026-01-05 05:28:59,677 - INFO -  AWS (us-east-1)   g6e.12xlarge   48      384       L40S:4   10.49      [32m   ‚úî[0m
2026-01-05 05:28:59,677 - INFO - ---------------------------------------------------------------------------------
2026-01-05 05:28:59,677 - INFO - [2müîç Multiple AWS instances satisfy L40S:4. The cheapest (gpus=L40S:4, g6e.12xlarge, ...) is considered among: g6e.24xlarge, g6e.12xlarge.[0m
2026-01-05 05:28:59,677 - INFO - To list more details, run: sky show-gpus L40S
2026-01-05 05:28:59,677 - INFO - 
2026-01-05 05:28:59,677 - INFO - [0m‚öôÔ∏é Launching on AWS us-east-1[0m (us-east-1a,us-east-1b,us-east-1c,us-east-1d).
2026-01-05 05:29:36,572 - INFO - [2m‚îî‚îÄ‚îÄ [0m[2mInstance is up.[0m
2026-01-05 05:30:03,076 - INFO - [0m[32m‚úì Cluster launched: roofline-tp2-pp2-2048in-512out.[0m[0m  [2mView logs: [1msky logs --provision roofline-tp2-pp2-2048in-512out[0m[0m
2026-01-05 05:30:03,077 - INFO - [0m‚öôÔ∏é Syncing files.
2026-01-05 05:30:03,178 - INFO -   [2mSyncing workdir (to 1 node): /home/ubuntu/projects/tandemn-profiling/roofline -> ~/sky_workdir[0m
2026-01-05 05:30:03,279 - INFO - [0m[32m‚úì Synced workdir.[0m[0m  [2mView logs: sky api logs -l sky-2026-01-05-05-28-58-498902/workdir_sync.log[0m
2026-01-05 05:30:03,579 - INFO - [0m[32m‚úì Setup detached.[0m[0m
2026-01-05 05:30:06,388 - INFO - [0m‚öôÔ∏é Job submitted, ID: 1
2026-01-05 05:30:08,878 - INFO - [2m‚îú‚îÄ‚îÄ [0m[2mWaiting for task resources on 1 node.[0m
2026-01-05 05:30:08,878 - INFO - [2m‚îî‚îÄ‚îÄ [0mJob started. Streaming logs... [2m(Ctrl-C to exit log streaming; job will not be killed)[0m
2026-01-05 05:30:10,686 - INFO - [36m(setup pid=3246)[0m + python3 -m pip install -U pip
2026-01-05 05:30:11,390 - INFO - [36m(setup pid=3246)[0m Requirement already satisfied: pip in /home/ubuntu/miniconda3/lib/python3.10/site-packages (23.3.1)
2026-01-05 05:30:11,390 - INFO - [36m(setup pid=3246)[0m Collecting pip
2026-01-05 05:30:12,293 - INFO - [36m(setup pid=3246)[0m   Downloading pip-25.3-py3-none-any.whl.metadata (4.7 kB)
2026-01-05 05:30:12,293 - INFO - [36m(setup pid=3246)[0m Downloading pip-25.3-py3-none-any.whl (1.8 MB)
2026-01-05 05:30:12,293 - INFO - [36m(setup pid=3246)[0m    ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 1.8/1.8 MB 48.2 MB/s eta 0:00:00
2026-01-05 05:30:12,293 - INFO - [36m(setup pid=3246)[0m Installing collected packages: pip
2026-01-05 05:30:12,293 - INFO - [36m(setup pid=3246)[0m   Attempting uninstall: pip
2026-01-05 05:30:12,293 - INFO - [36m(setup pid=3246)[0m     Found existing installation: pip 23.3.1
2026-01-05 05:30:12,293 - INFO - [36m(setup pid=3246)[0m     Uninstalling pip-23.3.1:
2026-01-05 05:30:13,095 - INFO - [36m(setup pid=3246)[0m       Successfully uninstalled pip-23.3.1
2026-01-05 05:30:13,899 - INFO - [36m(setup pid=3246)[0m Successfully installed pip-25.3
2026-01-05 05:30:13,899 - INFO - [36m(setup pid=3246)[0m + python3 -m pip install -U uv
2026-01-05 05:30:14,602 - INFO - [36m(setup pid=3246)[0m Collecting uv
2026-01-05 05:30:14,602 - INFO - [36m(setup pid=3246)[0m   Downloading uv-0.9.21-py3-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (11 kB)
2026-01-05 05:30:14,602 - INFO - [36m(setup pid=3246)[0m Downloading uv-0.9.21-py3-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (22.2 MB)
2026-01-05 05:30:14,602 - INFO - [36m(setup pid=3246)[0m    ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 22.2/22.2 MB 216.2 MB/s  0:00:00
2026-01-05 05:30:14,602 - INFO - [36m(setup pid=3246)[0m Installing collected packages: uv
2026-01-05 05:30:14,602 - INFO - [36m(setup pid=3246)[0m Successfully installed uv-0.9.21
2026-01-05 05:30:14,602 - INFO - [36m(setup pid=3246)[0m + uv venv --python 3.12 --seed
2026-01-05 05:30:15,406 - INFO - [36m(setup pid=3246)[0m Downloading cpython-3.12.12-linux-x86_64-gnu (download) (31.7MiB)
2026-01-05 05:30:15,406 - INFO - [36m(setup pid=3246)[0m  Downloaded cpython-3.12.12-linux-x86_64-gnu (download)
2026-01-05 05:30:16,008 - INFO - [36m(setup pid=3246)[0m Using CPython 3.12.12
2026-01-05 05:30:16,008 - INFO - [36m(setup pid=3246)[0m Creating virtual environment with seed packages at: .venv
2026-01-05 05:30:16,008 - INFO - [36m(setup pid=3246)[0m  + pip==25.3
2026-01-05 05:30:16,008 - INFO - [36m(setup pid=3246)[0m Activate with: source .venv/bin/activate
2026-01-05 05:30:16,008 - INFO - [36m(setup pid=3246)[0m + source .venv/bin/activate
2026-01-05 05:30:16,008 - INFO - [36m(setup pid=3246)[0m ++ '[' -z '' ']'
2026-01-05 05:30:16,008 - INFO - [36m(setup pid=3246)[0m ++ '[' -n x ']'
2026-01-05 05:30:16,008 - INFO - [36m(setup pid=3246)[0m ++ SCRIPT_PATH=.venv/bin/activate
2026-01-05 05:30:16,008 - INFO - [36m(setup pid=3246)[0m ++ '[' .venv/bin/activate = /tmp/sky_setup_sky-2026-01-05-05-28-58-498902 ']'
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ deactivate nondestructive
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ unset -f pydoc
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ '[' -z '' ']'
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ '[' -z '' ']'
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ hash -r
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ '[' -z '' ']'
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ unset VIRTUAL_ENV
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ unset VIRTUAL_ENV_PROMPT
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ '[' '!' nondestructive = nondestructive ']'
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ VIRTUAL_ENV=/home/ubuntu/sky_workdir/.venv
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ '[' linux-gnu = cygwin ']'
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ '[' linux-gnu = msys ']'
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ export VIRTUAL_ENV
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ '[' -z '' ']'
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ unset SCRIPT_PATH
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ _OLD_VIRTUAL_PATH=/home/ubuntu/.local/bin:/home/ubuntu/.local/bin:/home/ubuntu/miniconda3/bin:/home/ubuntu/miniconda3/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ PATH=/home/ubuntu/sky_workdir/.venv/bin:/home/ubuntu/.local/bin:/home/ubuntu/.local/bin:/home/ubuntu/miniconda3/bin:/home/ubuntu/miniconda3/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ export PATH
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ '[' xsky_workdir '!=' x ']'
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ VIRTUAL_ENV_PROMPT=sky_workdir
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ export VIRTUAL_ENV_PROMPT
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ '[' -z '' ']'
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ '[' -z '' ']'
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ _OLD_VIRTUAL_PS1='(base) ${debian_chroot:+($debian_chroot)}\u@\h:\w\$ '
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ PS1='(sky_workdir) (base) ${debian_chroot:+($debian_chroot)}\u@\h:\w\$ '
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ export PS1
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ alias pydoc
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ true
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m ++ hash -r
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m + uv pip install datasets requests pynvml
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m Resolved 41 packages in 60ms
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m Downloading hf-xet (3.2MiB)
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m Downloading pandas (11.8MiB)
2026-01-05 05:30:16,009 - INFO - [36m(setup pid=3246)[0m Downloading pyarrow (45.5MiB)
2026-01-05 05:30:16,010 - INFO - [36m(setup pid=3246)[0m Downloading aiohttp (1.7MiB)
2026-01-05 05:30:16,010 - INFO - [36m(setup pid=3246)[0m Downloading numpy (15.6MiB)
2026-01-05 05:30:16,010 - INFO - [36m(setup pid=3246)[0m  Downloaded hf-xet
2026-01-05 05:30:16,010 - INFO - [36m(setup pid=3246)[0m  Downloaded aiohttp
2026-01-05 05:30:16,609 - INFO - [36m(setup pid=3246)[0m  Downloaded numpy
2026-01-05 05:30:16,609 - INFO - [36m(setup pid=3246)[0m  Downloaded pyarrow
2026-01-05 05:30:17,211 - INFO - [36m(setup pid=3246)[0m  Downloaded pandas
2026-01-05 05:30:17,211 - INFO - [36m(setup pid=3246)[0m Prepared 37 packages in 873ms
2026-01-05 05:30:17,211 - INFO - [36m(setup pid=3246)[0m Installed 41 packages in 45ms
2026-01-05 05:30:17,211 - INFO - [36m(setup pid=3246)[0m  + aiohappyeyeballs==2.6.1
2026-01-05 05:30:17,211 - INFO - [36m(setup pid=3246)[0m  + aiohttp==3.13.3
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + aiosignal==1.4.0
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + anyio==4.12.0
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + attrs==25.4.0
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + certifi==2026.1.4
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + charset-normalizer==3.4.4
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + click==8.3.1
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + datasets==4.4.2
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + dill==0.4.0
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + filelock==3.20.2
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + frozenlist==1.8.0
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + fsspec==2025.10.0
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + h11==0.16.0
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + hf-xet==1.2.0
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + httpcore==1.0.9
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + httpx==0.28.1
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + huggingface-hub==1.2.3
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + idna==3.11
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + multidict==6.7.0
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + multiprocess==0.70.18
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + numpy==2.4.0
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + nvidia-ml-py==13.590.44
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + packaging==25.0
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + pandas==2.3.3
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + propcache==0.4.1
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + pyarrow==22.0.0
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + pynvml==13.0.1
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + python-dateutil==2.9.0.post0
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + pytz==2025.2
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + pyyaml==6.0.3
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + requests==2.32.5
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + shellingham==1.5.4
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + six==1.17.0
2026-01-05 05:30:17,212 - INFO - [36m(setup pid=3246)[0m  + tqdm==4.67.1
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m  + typer-slim==0.21.0
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m  + typing-extensions==4.15.0
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m  + tzdata==2025.3
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m  + urllib3==2.6.2
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m  + xxhash==3.6.0
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m  + yarl==1.22.0
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m + uv pip install vllm==0.10.0
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Resolved 141 packages in 299ms
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading transformers (11.4MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading sympy (6.0MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading tokenizers (3.1MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading networkx (2.0MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading pygments (1.2MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading scipy (34.0MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading uvloop (4.2MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading triton (148.5MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading outlines-core (2.2MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading pycountry (6.0MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading torchaudio (3.3MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading pillow (6.7MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading pydantic-core (2.0MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading nvidia-cusparselt-cu12 (149.5MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading torchvision (7.1MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading nvidia-nvjitlink-cu12 (18.8MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading tiktoken (1.1MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading mistral-common (6.2MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading nvidia-cublas-cu12 (374.9MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading soundfile (1.3MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading nvidia-curand-cu12 (53.7MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading llguidance (14.3MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading opencv-python-headless (51.5MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading nvidia-cusparse-cu12 (206.5MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading xformers (111.6MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading numpy (15.8MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading xgrammar (11.3MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading vllm (368.7MiB)
2026-01-05 05:30:17,213 - INFO - [36m(setup pid=3246)[0m Downloading nvidia-cufile-cu12 (1.1MiB)
2026-01-05 05:30:17,214 - INFO - [36m(setup pid=3246)[0m Downloading nvidia-cuda-cupti-cu12 (8.5MiB)
2026-01-05 05:30:17,214 - INFO - [36m(setup pid=3246)[0m Downloading ray (69.0MiB)
2026-01-05 05:30:17,214 - INFO - [36m(setup pid=3246)[0m Downloading torch (783.0MiB)
2026-01-05 05:30:17,214 - INFO - [36m(setup pid=3246)[0m Downloading llvmlite (40.4MiB)
2026-01-05 05:30:17,214 - INFO - [36m(setup pid=3246)[0m Downloading nvidia-cusolver-cu12 (150.9MiB)
2026-01-05 05:30:17,214 - INFO - [36m(setup pid=3246)[0m Downloading nvidia-cufft-cu12 (190.9MiB)
2026-01-05 05:30:17,214 - INFO - [36m(setup pid=3246)[0m Downloading nvidia-cuda-nvrtc-cu12 (22.6MiB)
2026-01-05 05:30:17,214 - INFO - [36m(setup pid=3246)[0m Downloading sentencepiece (1.3MiB)
2026-01-05 05:30:17,214 - INFO - [36m(setup pid=3246)[0m Downloading cupy-cuda12x (107.7MiB)
2026-01-05 05:30:17,214 - INFO - [36m(setup pid=3246)[0m Downloading numba (3.7MiB)
2026-01-05 05:30:17,214 - INFO - [36m(setup pid=3246)[0m Downloading nvidia-cudnn-cu12 (544.5MiB)
2026-01-05 05:30:17,214 - INFO - [36m(setup pid=3246)[0m Downloading setuptools (1.2MiB)
2026-01-05 05:30:17,214 - INFO - [36m(setup pid=3246)[0m Downloading nvidia-nccl-cu12 (192.0MiB)
2026-01-05 05:30:17,813 - INFO - [36m(setup pid=3246)[0m  Downloaded nvidia-cufile-cu12
2026-01-05 05:30:17,813 - INFO - [36m(setup pid=3246)[0m  Downloaded tiktoken
2026-01-05 05:30:17,813 - INFO - [36m(setup pid=3246)[0m  Downloaded soundfile
2026-01-05 05:30:17,813 - INFO - [36m(setup pid=3246)[0m  Downloaded sentencepiece
2026-01-05 05:30:17,813 - INFO - [36m(setup pid=3246)[0m  Downloaded pygments
2026-01-05 05:30:17,813 - INFO - [36m(setup pid=3246)[0m  Downloaded pydantic-core
2026-01-05 05:30:18,415 - INFO - [36m(setup pid=3246)[0m  Downloaded outlines-core
2026-01-05 05:30:18,415 - INFO - [36m(setup pid=3246)[0m  Downloaded setuptools
2026-01-05 05:30:18,415 - INFO - [36m(setup pid=3246)[0m  Downloaded tokenizers
2026-01-05 05:30:18,415 - INFO - [36m(setup pid=3246)[0m  Downloaded networkx
2026-01-05 05:30:18,415 - INFO - [36m(setup pid=3246)[0m  Downloaded torchaudio
2026-01-05 05:30:19,016 - INFO - [36m(setup pid=3246)[0m  Downloaded uvloop
2026-01-05 05:30:19,016 - INFO - [36m(setup pid=3246)[0m  Downloaded numba
2026-01-05 05:30:19,017 - INFO - [36m(setup pid=3246)[0m  Downloaded pycountry
2026-01-05 05:30:19,017 - INFO - [36m(setup pid=3246)[0m  Downloaded mistral-common
2026-01-05 05:30:19,017 - INFO - [36m(setup pid=3246)[0m  Downloaded pillow
2026-01-05 05:30:19,820 - INFO - [36m(setup pid=3246)[0m  Downloaded torchvision
2026-01-05 05:30:19,820 - INFO - [36m(setup pid=3246)[0m  Downloaded nvidia-cuda-cupti-cu12
2026-01-05 05:30:19,820 - INFO - [36m(setup pid=3246)[0m  Downloaded sympy
2026-01-05 05:30:19,820 - INFO - [36m(setup pid=3246)[0m  Downloaded xgrammar
2026-01-05 05:30:20,423 - INFO - [36m(setup pid=3246)[0m  Downloaded llguidance
2026-01-05 05:30:20,423 - INFO - [36m(setup pid=3246)[0m  Downloaded transformers
2026-01-05 05:30:21,024 - INFO - [36m(setup pid=3246)[0m  Downloaded numpy
2026-01-05 05:30:21,024 - INFO - [36m(setup pid=3246)[0m  Downloaded nvidia-nvjitlink-cu12
2026-01-05 05:30:21,626 - INFO - [36m(setup pid=3246)[0m  Downloaded nvidia-cuda-nvrtc-cu12
2026-01-05 05:30:23,229 - INFO - [36m(setup pid=3246)[0m  Downloaded scipy
2026-01-05 05:30:23,931 - INFO - [36m(setup pid=3246)[0m  Downloaded llvmlite
2026-01-05 05:30:24,635 - INFO - [36m(setup pid=3246)[0m  Downloaded nvidia-curand-cu12
2026-01-05 05:30:24,635 - INFO - [36m(setup pid=3246)[0m  Downloaded opencv-python-headless
2026-01-05 05:30:29,249 - INFO - [36m(setup pid=3246)[0m  Downloaded xformers
2026-01-05 05:30:30,151 - INFO - [36m(setup pid=3246)[0m  Downloaded cupy-cuda12x
2026-01-05 05:30:31,254 - INFO - [36m(setup pid=3246)[0m  Downloaded nvidia-cusparselt-cu12
2026-01-05 05:30:31,254 - INFO - [36m(setup pid=3246)[0m  Downloaded ray
2026-01-05 05:30:31,254 - INFO - [36m(setup pid=3246)[0m  Downloaded nvidia-cusolver-cu12
2026-01-05 05:30:32,155 - INFO - [36m(setup pid=3246)[0m  Downloaded triton
2026-01-05 05:30:32,657 - INFO - [36m(setup pid=3246)[0m  Downloaded nvidia-nccl-cu12
2026-01-05 05:30:32,657 - INFO - [36m(setup pid=3246)[0m  Downloaded nvidia-cufft-cu12
2026-01-05 05:30:33,561 - INFO - [36m(setup pid=3246)[0m  Downloaded nvidia-cusparse-cu12
2026-01-05 05:30:34,865 - INFO - [36m(setup pid=3246)[0m  Downloaded nvidia-cublas-cu12
2026-01-05 05:30:37,074 - INFO - [36m(setup pid=3246)[0m  Downloaded nvidia-cudnn-cu12
2026-01-05 05:30:37,979 - INFO - [36m(setup pid=3246)[0m  Downloaded vllm
2026-01-05 05:30:42,893 - INFO - [36m(setup pid=3246)[0m  Downloaded torch
2026-01-05 05:30:42,893 - INFO - [36m(setup pid=3246)[0m Prepared 109 packages in 25.72s
2026-01-05 05:30:42,894 - INFO - [36m(setup pid=3246)[0m Uninstalled 2 packages in 19ms
2026-01-05 05:30:43,597 - INFO - [36m(setup pid=3246)[0m Installed 113 packages in 262ms
2026-01-05 05:30:43,597 - INFO - [36m(setup pid=3246)[0m  + annotated-doc==0.0.4
2026-01-05 05:30:43,597 - INFO - [36m(setup pid=3246)[0m  + annotated-types==0.7.0
2026-01-05 05:30:43,597 - INFO - [36m(setup pid=3246)[0m  + astor==0.8.1
2026-01-05 05:30:43,597 - INFO - [36m(setup pid=3246)[0m  + blake3==1.0.8
2026-01-05 05:30:43,597 - INFO - [36m(setup pid=3246)[0m  + cachetools==6.2.4
2026-01-05 05:30:43,597 - INFO - [36m(setup pid=3246)[0m  + cbor2==5.8.0
2026-01-05 05:30:43,597 - INFO - [36m(setup pid=3246)[0m  + cffi==2.0.0
2026-01-05 05:30:43,597 - INFO - [36m(setup pid=3246)[0m  + cloudpickle==3.1.2
2026-01-05 05:30:43,597 - INFO - [36m(setup pid=3246)[0m  + compressed-tensors==0.10.2
2026-01-05 05:30:43,597 - INFO - [36m(setup pid=3246)[0m  + cupy-cuda12x==13.6.0
2026-01-05 05:30:43,597 - INFO - [36m(setup pid=3246)[0m  + depyf==0.19.0
2026-01-05 05:30:43,597 - INFO - [36m(setup pid=3246)[0m  + diskcache==5.6.3
2026-01-05 05:30:43,598 - INFO - [36m(setup pid=3246)[0m  + distro==1.9.0
2026-01-05 05:30:43,598 - INFO - [36m(setup pid=3246)[0m  + dnspython==2.8.0
2026-01-05 05:30:43,598 - INFO - [36m(setup pid=3246)[0m  + einops==0.8.1
2026-01-05 05:30:43,598 - INFO - [36m(setup pid=3246)[0m  + email-validator==2.3.0
2026-01-05 05:30:43,598 - INFO - [36m(setup pid=3246)[0m  + fastapi==0.128.0
2026-01-05 05:30:43,598 - INFO - [36m(setup pid=3246)[0m  + fastapi-cli==0.0.20
2026-01-05 05:30:43,598 - INFO - [36m(setup pid=3246)[0m  + fastapi-cloud-cli==0.8.0
2026-01-05 05:30:43,598 - INFO - [36m(setup pid=3246)[0m  + fastar==0.8.0
2026-01-05 05:30:43,598 - INFO - [36m(setup pid=3246)[0m  + fastrlock==0.8.3
2026-01-05 05:30:43,598 - INFO - [36m(setup pid=3246)[0m  + gguf==0.17.1
2026-01-05 05:30:43,598 - INFO - [36m(setup pid=3246)[0m  + httptools==0.7.1
2026-01-05 05:30:43,598 - INFO - [36m(setup pid=3246)[0m  - huggingface-hub==1.2.3
2026-01-05 05:30:43,598 - INFO - [36m(setup pid=3246)[0m  + huggingface-hub==0.36.0
2026-01-05 05:30:43,598 - INFO - [36m(setup pid=3246)[0m  + interegular==0.3.3
2026-01-05 05:30:43,598 - INFO - [36m(setup pid=3246)[0m  + jinja2==3.1.6
2026-01-05 05:30:43,598 - INFO - [36m(setup pid=3246)[0m  + jiter==0.12.0
2026-01-05 05:30:43,598 - INFO - [36m(setup pid=3246)[0m  + jsonschema==4.25.1
2026-01-05 05:30:43,598 - INFO - [36m(setup pid=3246)[0m  + jsonschema-specifications==2025.9.1
2026-01-05 05:30:43,599 - INFO - [36m(setup pid=3246)[0m  + lark==1.2.2
2026-01-05 05:30:43,599 - INFO - [36m(setup pid=3246)[0m  + llguidance==0.7.30
2026-01-05 05:30:43,599 - INFO - [36m(setup pid=3246)[0m  + llvmlite==0.44.0
2026-01-05 05:30:43,599 - INFO - [36m(setup pid=3246)[0m  + lm-format-enforcer==0.10.12
2026-01-05 05:30:43,599 - INFO - [36m(setup pid=3246)[0m  + markdown-it-py==4.0.0
2026-01-05 05:30:43,599 - INFO - [36m(setup pid=3246)[0m  + markupsafe==3.0.3
2026-01-05 05:30:43,599 - INFO - [36m(setup pid=3246)[0m  + mdurl==0.1.2
2026-01-05 05:30:43,599 - INFO - [36m(setup pid=3246)[0m  + mistral-common==1.8.8
2026-01-05 05:30:43,599 - INFO - [36m(setup pid=3246)[0m  + mpmath==1.3.0
2026-01-05 05:30:43,599 - INFO - [36m(setup pid=3246)[0m  + msgpack==1.1.2
2026-01-05 05:30:43,599 - INFO - [36m(setup pid=3246)[0m  + msgspec==0.20.0
2026-01-05 05:30:43,599 - INFO - [36m(setup pid=3246)[0m  + networkx==3.6.1
2026-01-05 05:30:43,599 - INFO - [36m(setup pid=3246)[0m  + ninja==1.13.0
2026-01-05 05:30:43,599 - INFO - [36m(setup pid=3246)[0m  + numba==0.61.2
2026-01-05 05:30:43,599 - INFO - [36m(setup pid=3246)[0m  - numpy==2.4.0
2026-01-05 05:30:43,599 - INFO - [36m(setup pid=3246)[0m  + numpy==2.2.6
2026-01-05 05:30:43,599 - INFO - [36m(setup pid=3246)[0m  + nvidia-cublas-cu12==12.6.4.1
2026-01-05 05:30:43,599 - INFO - [36m(setup pid=3246)[0m  + nvidia-cuda-cupti-cu12==12.6.80
2026-01-05 05:30:43,600 - INFO - [36m(setup pid=3246)[0m  + nvidia-cuda-nvrtc-cu12==12.6.77
2026-01-05 05:30:43,600 - INFO - [36m(setup pid=3246)[0m  + nvidia-cuda-runtime-cu12==12.6.77
2026-01-05 05:30:43,600 - INFO - [36m(setup pid=3246)[0m  + nvidia-cudnn-cu12==9.5.1.17
2026-01-05 05:30:43,600 - INFO - [36m(setup pid=3246)[0m  + nvidia-cufft-cu12==11.3.0.4
2026-01-05 05:30:43,600 - INFO - [36m(setup pid=3246)[0m  + nvidia-cufile-cu12==1.11.1.6
2026-01-05 05:30:43,600 - INFO - [36m(setup pid=3246)[0m  + nvidia-curand-cu12==10.3.7.77
2026-01-05 05:30:43,600 - INFO - [36m(setup pid=3246)[0m  + nvidia-cusolver-cu12==11.7.1.2
2026-01-05 05:30:43,600 - INFO - [36m(setup pid=3246)[0m  + nvidia-cusparse-cu12==12.5.4.2
2026-01-05 05:30:43,600 - INFO - [36m(setup pid=3246)[0m  + nvidia-cusparselt-cu12==0.6.3
2026-01-05 05:30:43,600 - INFO - [36m(setup pid=3246)[0m  + nvidia-nccl-cu12==2.26.2
2026-01-05 05:30:43,600 - INFO - [36m(setup pid=3246)[0m  + nvidia-nvjitlink-cu12==12.6.85
2026-01-05 05:30:43,600 - INFO - [36m(setup pid=3246)[0m  + nvidia-nvtx-cu12==12.6.77
2026-01-05 05:30:43,600 - INFO - [36m(setup pid=3246)[0m  + openai==1.90.0
2026-01-05 05:30:43,600 - INFO - [36m(setup pid=3246)[0m  + opencv-python-headless==4.12.0.88
2026-01-05 05:30:43,600 - INFO - [36m(setup pid=3246)[0m  + outlines-core==0.2.10
2026-01-05 05:30:43,600 - INFO - [36m(setup pid=3246)[0m  + partial-json-parser==0.2.1.1.post7
2026-01-05 05:30:43,600 - INFO - [36m(setup pid=3246)[0m  + pillow==12.1.0
2026-01-05 05:30:43,600 - INFO - [36m(setup pid=3246)[0m  + prometheus-client==0.23.1
2026-01-05 05:30:43,600 - INFO - [36m(setup pid=3246)[0m  + prometheus-fastapi-instrumentator==7.1.0
2026-01-05 05:30:43,600 - INFO - [36m(setup pid=3246)[0m  + protobuf==6.33.2
2026-01-05 05:30:43,601 - INFO - [36m(setup pid=3246)[0m  + psutil==7.2.1
2026-01-05 05:30:43,601 - INFO - [36m(setup pid=3246)[0m  + py-cpuinfo==9.0.0
2026-01-05 05:30:43,601 - INFO - [36m(setup pid=3246)[0m  + pybase64==1.4.3
2026-01-05 05:30:43,601 - INFO - [36m(setup pid=3246)[0m  + pycountry==24.6.1
2026-01-05 05:30:43,601 - INFO - [36m(setup pid=3246)[0m  + pycparser==2.23
2026-01-05 05:30:43,601 - INFO - [36m(setup pid=3246)[0m  + pydantic==2.12.5
2026-01-05 05:30:43,601 - INFO - [36m(setup pid=3246)[0m  + pydantic-core==2.41.5
2026-01-05 05:30:43,601 - INFO - [36m(setup pid=3246)[0m  + pydantic-extra-types==2.11.0
2026-01-05 05:30:43,601 - INFO - [36m(setup pid=3246)[0m  + pydantic-settings==2.12.0
2026-01-05 05:30:43,601 - INFO - [36m(setup pid=3246)[0m  + pygments==2.19.2
2026-01-05 05:30:43,601 - INFO - [36m(setup pid=3246)[0m  + python-dotenv==1.2.1
2026-01-05 05:30:43,601 - INFO - [36m(setup pid=3246)[0m  + python-json-logger==4.0.0
2026-01-05 05:30:43,601 - INFO - [36m(setup pid=3246)[0m  + python-multipart==0.0.21
2026-01-05 05:30:43,601 - INFO - [36m(setup pid=3246)[0m  + pyzmq==27.1.0
2026-01-05 05:30:43,601 - INFO - [36m(setup pid=3246)[0m  + ray==2.53.0
2026-01-05 05:30:43,601 - INFO - [36m(setup pid=3246)[0m  + referencing==0.37.0
2026-01-05 05:30:43,601 - INFO - [36m(setup pid=3246)[0m  + regex==2025.11.3
2026-01-05 05:30:43,601 - INFO - [36m(setup pid=3246)[0m  + rich==14.2.0
2026-01-05 05:30:43,601 - INFO - [36m(setup pid=3246)[0m  + rich-toolkit==0.17.1
2026-01-05 05:30:43,602 - INFO - [36m(setup pid=3246)[0m  + rignore==0.7.6
2026-01-05 05:30:43,602 - INFO - [36m(setup pid=3246)[0m  + rpds-py==0.30.0
2026-01-05 05:30:43,602 - INFO - [36m(setup pid=3246)[0m  + safetensors==0.7.0
2026-01-05 05:30:43,602 - INFO - [36m(setup pid=3246)[0m  + scipy==1.16.3
2026-01-05 05:30:43,602 - INFO - [36m(setup pid=3246)[0m  + sentencepiece==0.2.1
2026-01-05 05:30:43,602 - INFO - [36m(setup pid=3246)[0m  + sentry-sdk==2.48.0
2026-01-05 05:30:43,602 - INFO - [36m(setup pid=3246)[0m  + setuptools==79.0.1
2026-01-05 05:30:43,602 - INFO - [36m(setup pid=3246)[0m  + sniffio==1.3.1
2026-01-05 05:30:43,602 - INFO - [36m(setup pid=3246)[0m  + soundfile==0.13.1
2026-01-05 05:30:43,602 - INFO - [36m(setup pid=3246)[0m  + soxr==1.0.0
2026-01-05 05:30:43,602 - INFO - [36m(setup pid=3246)[0m  + starlette==0.50.0
2026-01-05 05:30:43,602 - INFO - [36m(setup pid=3246)[0m  + sympy==1.14.0
2026-01-05 05:30:43,602 - INFO - [36m(setup pid=3246)[0m  + tiktoken==0.12.0
2026-01-05 05:30:43,602 - INFO - [36m(setup pid=3246)[0m  + tokenizers==0.22.1
2026-01-05 05:30:43,602 - INFO - [36m(setup pid=3246)[0m  + torch==2.7.1
2026-01-05 05:30:43,602 - INFO - [36m(setup pid=3246)[0m  + torchaudio==2.7.1
2026-01-05 05:30:43,602 - INFO - [36m(setup pid=3246)[0m  + torchvision==0.22.1
2026-01-05 05:30:43,602 - INFO - [36m(setup pid=3246)[0m  + transformers==4.57.3
2026-01-05 05:30:43,602 - INFO - [36m(setup pid=3246)[0m  + triton==3.3.1
2026-01-05 05:30:43,602 - INFO - [36m(setup pid=3246)[0m  + typer==0.21.0
2026-01-05 05:30:43,603 - INFO - [36m(setup pid=3246)[0m  + typing-inspection==0.4.2
2026-01-05 05:30:43,603 - INFO - [36m(setup pid=3246)[0m  + uvicorn==0.40.0
2026-01-05 05:30:43,603 - INFO - [36m(setup pid=3246)[0m  + uvloop==0.22.1
2026-01-05 05:30:43,603 - INFO - [36m(setup pid=3246)[0m  + vllm==0.10.0
2026-01-05 05:30:43,603 - INFO - [36m(setup pid=3246)[0m  + watchfiles==1.1.1
2026-01-05 05:30:43,603 - INFO - [36m(setup pid=3246)[0m  + websockets==15.0.1
2026-01-05 05:30:43,603 - INFO - [36m(setup pid=3246)[0m  + xformers==0.0.31
2026-01-05 05:30:43,603 - INFO - [36m(setup pid=3246)[0m  + xgrammar==0.1.21
2026-01-05 05:30:43,603 - INFO - [36m(setup pid=3246)[0m + mkdir -p /tmp/lmcache_disk
2026-01-05 05:30:44,199 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + source .venv/bin/activate
2026-01-05 05:30:44,199 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ '[' -z '' ']'
2026-01-05 05:30:44,199 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ '[' -n x ']'
2026-01-05 05:30:44,199 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ SCRIPT_PATH=.venv/bin/activate
2026-01-05 05:30:44,199 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ '[' .venv/bin/activate = /tmp/sky_app__0vl1bit ']'
2026-01-05 05:30:44,199 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ deactivate nondestructive
2026-01-05 05:30:44,199 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ unset -f pydoc
2026-01-05 05:30:44,199 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ '[' -z '' ']'
2026-01-05 05:30:44,199 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ '[' -z '' ']'
2026-01-05 05:30:44,199 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ hash -r
2026-01-05 05:30:44,199 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ '[' -z '' ']'
2026-01-05 05:30:44,199 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ unset VIRTUAL_ENV
2026-01-05 05:30:44,199 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ unset VIRTUAL_ENV_PROMPT
2026-01-05 05:30:44,199 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ '[' '!' nondestructive = nondestructive ']'
2026-01-05 05:30:44,200 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ VIRTUAL_ENV=/home/ubuntu/sky_workdir/.venv
2026-01-05 05:30:44,200 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ '[' linux-gnu = cygwin ']'
2026-01-05 05:30:44,200 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ '[' linux-gnu = msys ']'
2026-01-05 05:30:44,200 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ export VIRTUAL_ENV
2026-01-05 05:30:44,200 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ '[' -z '' ']'
2026-01-05 05:30:44,200 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ unset SCRIPT_PATH
2026-01-05 05:30:44,200 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ _OLD_VIRTUAL_PATH=/home/ubuntu/.local/bin:/home/ubuntu/.local/bin:/home/ubuntu/miniconda3/bin:/home/ubuntu/miniconda3/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
2026-01-05 05:30:44,200 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ PATH=/home/ubuntu/sky_workdir/.venv/bin:/home/ubuntu/.local/bin:/home/ubuntu/.local/bin:/home/ubuntu/miniconda3/bin:/home/ubuntu/miniconda3/condabin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
2026-01-05 05:30:44,200 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ export PATH
2026-01-05 05:30:44,200 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ '[' xsky_workdir '!=' x ']'
2026-01-05 05:30:44,200 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ VIRTUAL_ENV_PROMPT=sky_workdir
2026-01-05 05:30:44,200 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ export VIRTUAL_ENV_PROMPT
2026-01-05 05:30:44,200 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ '[' -z '' ']'
2026-01-05 05:30:44,200 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ '[' -z '' ']'
2026-01-05 05:30:44,200 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ _OLD_VIRTUAL_PS1='(base) ${debian_chroot:+($debian_chroot)}\u@\h:\w\$ '
2026-01-05 05:30:44,200 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ PS1='(sky_workdir) (base) ${debian_chroot:+($debian_chroot)}\u@\h:\w\$ '
2026-01-05 05:30:44,200 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ export PS1
2026-01-05 05:30:44,200 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ alias pydoc
2026-01-05 05:30:44,200 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ true
2026-01-05 05:30:44,201 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ++ hash -r
2026-01-05 05:30:44,201 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + '[' '!' -d lmcache ']'
2026-01-05 05:30:44,201 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + git clone https://github.com/lmcache/lmcache.git
2026-01-05 05:30:44,201 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m Cloning into 'lmcache'...
2026-01-05 05:30:44,901 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + cd lmcache
2026-01-05 05:30:44,901 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + git checkout v0.3.6
2026-01-05 05:30:45,804 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m Note: switching to 'v0.3.6'.
2026-01-05 05:30:45,804 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m
2026-01-05 05:30:45,804 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m You are in 'detached HEAD' state. You can look around, make experimental
2026-01-05 05:30:45,804 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m changes and commit them, and you can discard any commits you make in this
2026-01-05 05:30:45,804 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m state without impacting any branches by switching back to a branch.
2026-01-05 05:30:45,804 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m
2026-01-05 05:30:45,805 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m If you want to create a new branch to retain commits you create, you may
2026-01-05 05:30:45,805 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m do so (now or later) by using -c with the switch command. Example:
2026-01-05 05:30:45,805 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m
2026-01-05 05:30:45,805 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m   git switch -c <new-branch-name>
2026-01-05 05:30:45,805 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m
2026-01-05 05:30:45,805 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m Or undo this operation with:
2026-01-05 05:30:45,805 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m
2026-01-05 05:30:45,805 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m   git switch -
2026-01-05 05:30:45,805 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m
2026-01-05 05:30:45,805 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m Turn off this advice by setting config variable advice.detachedHead to false
2026-01-05 05:30:45,805 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m
2026-01-05 05:30:45,805 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m HEAD is now at cad4db1 [Core] Add backward compatibility with vllm (#1583)
2026-01-05 05:30:45,805 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + export TORCH_CUDA_ARCH_LIST=8.0
2026-01-05 05:30:45,805 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + TORCH_CUDA_ARCH_LIST=8.0
2026-01-05 05:30:45,805 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + uv pip install . --no-build-isolation
2026-01-05 05:30:45,805 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m Using Python 3.12.12 environment at: /home/ubuntu/sky_workdir/.venv
2026-01-05 05:30:49,715 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m Resolved 62 packages in 4.36s
2026-01-05 05:30:49,716 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m Installed 1 package in 13ms
2026-01-05 05:30:49,716 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m    Building lmcache @ file:///home/ubuntu/sky_workdir/lmcache
2026-01-05 05:30:49,716 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m Downloading awscrt (3.9MiB)
2026-01-05 05:30:49,716 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m  Downloaded awscrt
2026-01-05 05:31:44,019 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m       Built lmcache @ file:///home/ubuntu/sky_workdir/lmcache
2026-01-05 05:31:44,019 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m Prepared 9 packages without build isolation in 54.30s
2026-01-05 05:31:44,019 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m Installed 9 packages in 5ms
2026-01-05 05:31:44,019 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m  + aiofile==3.9.0
2026-01-05 05:31:44,019 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m  + aiofiles==25.1.0
2026-01-05 05:31:44,019 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m  + awscrt==0.30.0
2026-01-05 05:31:44,020 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m  + caio==0.9.25
2026-01-05 05:31:44,020 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m  + cufile-python==0.2.0
2026-01-05 05:31:44,020 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m  + lmcache==0.0.0 (from file:///home/ubuntu/sky_workdir/lmcache)
2026-01-05 05:31:44,020 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m  + nvtx==0.2.14
2026-01-05 05:31:44,020 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m  + redis==7.1.0
2026-01-05 05:31:44,020 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m  + setuptools-scm==9.2.2
2026-01-05 05:31:44,020 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m  + sortedcontainers==2.4.0
2026-01-05 05:31:44,020 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + cd ..
2026-01-05 05:31:44,020 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + export LMCACHE_USE_EXPERIMENTAL=True
2026-01-05 05:31:44,020 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + LMCACHE_USE_EXPERIMENTAL=True
2026-01-05 05:31:44,020 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + export LMCACHE_CHUNK_SIZE=256
2026-01-05 05:31:44,020 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + LMCACHE_CHUNK_SIZE=256
2026-01-05 05:31:44,020 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + export LMCACHE_LOCAL_CPU=True
2026-01-05 05:31:44,020 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + LMCACHE_LOCAL_CPU=True
2026-01-05 05:31:44,020 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + export LMCACHE_MAX_LOCAL_CPU_SIZE=40.0
2026-01-05 05:31:44,020 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + LMCACHE_MAX_LOCAL_CPU_SIZE=40.0
2026-01-05 05:31:44,020 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + export LMCACHE_SAVE_UNFULL_CHUNK=True
2026-01-05 05:31:44,020 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + LMCACHE_SAVE_UNFULL_CHUNK=True
2026-01-05 05:31:44,021 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + export LMCACHE_ENABLE_ASYNC_LOADING=False
2026-01-05 05:31:44,021 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + LMCACHE_ENABLE_ASYNC_LOADING=False
2026-01-05 05:31:44,021 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + export LMCACHE_REMOTE_SERDE=cachegen
2026-01-05 05:31:44,021 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + LMCACHE_REMOTE_SERDE=cachegen
2026-01-05 05:31:44,021 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + export LMCACHE_USE_LAYERWISE=True
2026-01-05 05:31:44,021 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + LMCACHE_USE_LAYERWISE=True
2026-01-05 05:31:44,021 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + export LMCACHE_ENABLE_LAZY_MEMORY_ALLOCATOR=True
2026-01-05 05:31:44,021 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + LMCACHE_ENABLE_LAZY_MEMORY_ALLOCATOR=True
2026-01-05 05:31:44,021 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + export NCCL_P2P_DISABLE=1
2026-01-05 05:31:44,021 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + NCCL_P2P_DISABLE=1
2026-01-05 05:31:44,021 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + export NCCL_TIMEOUT=3600
2026-01-05 05:31:44,021 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + NCCL_TIMEOUT=3600
2026-01-05 05:31:44,021 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + export TORCH_NCCL_BLOCKING_WAIT=1
2026-01-05 05:31:44,021 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + TORCH_NCCL_BLOCKING_WAIT=1
2026-01-05 05:31:44,021 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + export TORCH_NCCL_ASYNC_ERROR_HANDLING=1
2026-01-05 05:31:44,021 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + TORCH_NCCL_ASYNC_ERROR_HANDLING=1
2026-01-05 05:31:44,021 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + export TORCH_NCCL_TRACE_BUFFER_SIZE=10000
2026-01-05 05:31:44,021 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + TORCH_NCCL_TRACE_BUFFER_SIZE=10000
2026-01-05 05:31:44,021 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + export TORCH_DISTRIBUTED_DEBUG=DETAIL
2026-01-05 05:31:44,021 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + TORCH_DISTRIBUTED_DEBUG=DETAIL
2026-01-05 05:31:44,520 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + export NCCL_DEBUG=INFO
2026-01-05 05:31:44,520 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + NCCL_DEBUG=INFO
2026-01-05 05:31:44,520 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + export RAY_DASHBOARD_HOST=0.0.0.0
2026-01-05 05:31:44,520 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + RAY_DASHBOARD_HOST=0.0.0.0
2026-01-05 05:31:44,520 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + export RAY_HEAD_PORT=6379
2026-01-05 05:31:44,520 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + RAY_HEAD_PORT=6379
2026-01-05 05:31:44,520 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + export RAY_DASHBOARD_PORT=8265
2026-01-05 05:31:44,520 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + RAY_DASHBOARD_PORT=8265
2026-01-05 05:31:44,520 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + echo 'Starting Ray for single-node pipeline parallelism...'
2026-01-05 05:31:44,520 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m Starting Ray for single-node pipeline parallelism...
2026-01-05 05:31:44,520 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + uv run ray start --head --port=6379 --dashboard-host=0.0.0.0 --dashboard-port=8265 --num-cpus=0
2026-01-05 05:31:45,422 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m 2026-01-05 05:31:45,176	INFO usage_lib.py:447 -- Usage stats collection is disabled.
2026-01-05 05:31:45,422 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m 2026-01-05 05:31:45,177	INFO scripts.py:917 -- Local node IP: 172.31.43.142
2026-01-05 05:31:46,629 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m 2026-01-05 05:31:46,467	SUCC scripts.py:956 -- --------------------
2026-01-05 05:31:46,629 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m 2026-01-05 05:31:46,467	SUCC scripts.py:957 -- Ray runtime started.
2026-01-05 05:31:46,629 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m 2026-01-05 05:31:46,467	SUCC scripts.py:958 -- --------------------
2026-01-05 05:31:46,629 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m 2026-01-05 05:31:46,467	INFO scripts.py:960 -- Next steps
2026-01-05 05:31:46,629 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m 2026-01-05 05:31:46,467	INFO scripts.py:963 -- To add another node to this Ray cluster, run
2026-01-05 05:31:46,629 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m 2026-01-05 05:31:46,467	INFO scripts.py:966 --   ray start --address='172.31.43.142:6379'
2026-01-05 05:31:46,630 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m 2026-01-05 05:31:46,467	INFO scripts.py:975 -- To connect to this Ray cluster:
2026-01-05 05:31:46,630 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m 2026-01-05 05:31:46,467	INFO scripts.py:977 -- import ray
2026-01-05 05:31:46,630 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m 2026-01-05 05:31:46,467	INFO scripts.py:978 -- ray.init()
2026-01-05 05:31:46,630 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m 2026-01-05 05:31:46,467	INFO scripts.py:1009 -- To terminate the Ray runtime, run
2026-01-05 05:31:46,630 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m 2026-01-05 05:31:46,467	INFO scripts.py:1010 --   ray stop
2026-01-05 05:31:46,630 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m 2026-01-05 05:31:46,467	INFO scripts.py:1013 -- To view the status of the cluster, use
2026-01-05 05:31:46,630 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m 2026-01-05 05:31:46,467	INFO scripts.py:1014 --   ray status
2026-01-05 05:31:47,332 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + sleep 5
2026-01-05 05:31:51,750 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + uv run ray status --address=127.0.0.1:6379
2026-01-05 05:31:52,352 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ======== Autoscaler status: 2026-01-05 05:31:50.974998 ========
2026-01-05 05:31:52,352 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m Node status
2026-01-05 05:31:52,352 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ---------------------------------------------------------------
2026-01-05 05:31:52,352 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m Active:
2026-01-05 05:31:52,352 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m  1 node_0f5204c99bc4d3dda71d5f6e4a41ae54749bc920a52413e725288ac4
2026-01-05 05:31:52,352 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m Pending:
2026-01-05 05:31:52,352 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m  (no pending nodes)
2026-01-05 05:31:52,352 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m Recent failures:
2026-01-05 05:31:52,352 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m  (no failures)
2026-01-05 05:31:52,352 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m
2026-01-05 05:31:52,352 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m Resources
2026-01-05 05:31:52,352 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ---------------------------------------------------------------
2026-01-05 05:31:52,352 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m Total Usage:
2026-01-05 05:31:52,352 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m  0.0/4.0 GPU
2026-01-05 05:31:52,352 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m  0B/252.50GiB memory
2026-01-05 05:31:52,352 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m  0B/108.21GiB object_store_memory
2026-01-05 05:31:52,353 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m
2026-01-05 05:31:52,353 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m From request_resources:
2026-01-05 05:31:52,353 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m  (none)
2026-01-05 05:31:52,353 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m Pending Demands:
2026-01-05 05:31:52,353 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m  (no resource demands)
2026-01-05 05:31:52,353 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + PYTHONHASHSEED=0
2026-01-05 05:31:52,353 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m + python roofline_benchmarks/benchmark_roofline-tp2-pp2-2048in-512out.py
2026-01-05 05:32:00,981 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m INFO 01-05 05:32:00 [__init__.py:235] Automatically detected platform cuda.
2026-01-05 05:32:02,183 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m
2026-01-05 05:32:02,183 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ======================================================================
2026-01-05 05:32:02,183 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m Running: TP=2, PP=2, input=2048, output=512
2026-01-05 05:32:02,183 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ======================================================================
2026-01-05 05:32:08,407 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m `torch_dtype` is deprecated! Use `dtype` instead!
2026-01-05 05:32:08,407 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m INFO 01-05 05:32:08 [config.py:1604] Using max model len 2559
2026-01-05 05:32:08,407 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m INFO 01-05 05:32:08 [config.py:2434] Chunked prefill is enabled with max_num_batched_tokens=8192.
2026-01-05 05:32:10,215 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m INFO 01-05 05:32:09 [core.py:572] Waiting for init message from front-end.
2026-01-05 05:32:10,215 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m INFO 01-05 05:32:09 [core.py:71] Initializing a V1 LLM engine (v0.10.0) with config: model='deepseek-ai/DeepSeek-R1-Distill-Llama-70B', speculative_config=None, tokenizer='deepseek-ai/DeepSeek-R1-Distill-Llama-70B', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config={}, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=2559, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=2, pipeline_parallel_size=2, disable_custom_all_reduce=False, quantization=None, enforce_eager=True, kv_cache_dtype=auto,  device_config=cuda, decoding_config=DecodingConfig(backend='auto', disable_fallback=False, disable_any_whitespace=False, disable_additional_properties=False, reasoning_backend=''), observability_config=ObservabilityConfig(show_hidden_metrics_for_version=None, otlp_traces_endpoint=None, collect_detailed_traces=None), seed=0, served_model_name=deepseek-ai/DeepSeek-R1-Distill-Llama-70B, num_scheduler_steps=1, multi_step_stream_outputs=True, enable_prefix_caching=False, chunked_prefill_enabled=True, use_async_output_proc=False, pooler_config=None, compilation_config={"level":0,"debug_dump_path":"","cache_dir":"","backend":"","custom_ops":[],"splitting_ops":[],"use_inductor":true,"compile_sizes":[],"inductor_compile_config":{"enable_auto_functionalized_v2":false},"inductor_passes":{},"use_cudagraph":true,"cudagraph_num_of_warmups":0,"cudagraph_capture_sizes":[],"cudagraph_copy_inputs":false,"full_cuda_graph":false,"max_capture_size":0,"local_cache_dir":null}
2026-01-05 05:32:10,215 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m 2026-01-05 05:32:09,947	INFO worker.py:1680 -- Using address 127.0.0.1:6379 set in the environment variable RAY_ADDRESS
2026-01-05 05:32:10,215 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m 2026-01-05 05:32:09,963	INFO worker.py:1821 -- Connecting to existing Ray cluster at address: 172.31.43.142:6379...
2026-01-05 05:32:10,215 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m 2026-01-05 05:32:09,976	INFO worker.py:2007 -- Connected to Ray cluster.
2026-01-05 05:32:10,215 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m INFO 01-05 05:32:10 [ray_utils.py:336] No current placement group found. Creating a new placement group.
2026-01-05 05:32:11,119 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m INFO 01-05 05:32:10 [ray_distributed_executor.py:169] use_ray_spmd_worker: True
2026-01-05 05:32:14,030 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(pid=7462)[0m INFO 01-05 05:32:13 [__init__.py:235] Automatically detected platform cuda.
2026-01-05 05:32:14,030 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(pid=7464)[0m INFO 01-05 05:32:13 [__init__.py:235] Automatically detected platform cuda.
2026-01-05 05:32:14,934 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(pid=7465)[0m INFO 01-05 05:32:13 [__init__.py:235] Automatically detected platform cuda.
2026-01-05 05:32:14,934 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(pid=7463)[0m INFO 01-05 05:32:13 [__init__.py:235] Automatically detected platform cuda.
2026-01-05 05:32:14,934 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m INFO 01-05 05:32:14 [ray_env.py:63] RAY_NON_CARRY_OVER_ENV_VARS from config: set()
2026-01-05 05:32:14,934 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m INFO 01-05 05:32:14 [ray_env.py:65] Copying the following environment variables to workers: ['VLLM_USE_RAY_SPMD_WORKER', 'VLLM_USE_RAY_COMPILED_DAG', 'VLLM_USE_V1']
2026-01-05 05:32:14,934 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m INFO 01-05 05:32:14 [ray_env.py:68] If certain env vars should NOT be copied, add them to /home/ubuntu/.config/vllm/ray_non_carry_over_env_vars.json file
2026-01-05 05:32:15,838 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(pid=gcs_server)[0m [2026-01-05 05:32:15,640 E 6963 6963] (gcs_server) gcs_server.cc:303: Failed to establish connection to the event+metrics exporter agent. Events and metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
2026-01-05 05:32:16,641 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [33m(raylet)[0m [2026-01-05 05:32:16,394 E 7141 7141] (raylet) main.cc:1032: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
2026-01-05 05:32:18,447 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m INFO 01-05 05:32:18 [__init__.py:1375] Found nccl from library libnccl.so.2
2026-01-05 05:32:18,447 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m INFO 01-05 05:32:18 [pynccl.py:70] vLLM is using nccl==2.26.2
2026-01-05 05:32:18,447 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Bootstrap: Using enp39s0:172.31.43.142<0>
2026-01-05 05:32:18,447 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO cudaDriverVersion 12020
2026-01-05 05:32:18,447 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO NCCL version 2.26.2+cuda12.2
2026-01-05 05:32:18,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m INFO 01-05 05:32:18 [__init__.py:1375] Found nccl from library libnccl.so.2
2026-01-05 05:32:18,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m INFO 01-05 05:32:18 [pynccl.py:70] vLLM is using nccl==2.26.2
2026-01-05 05:32:18,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO cudaDriverVersion 12020
2026-01-05 05:32:18,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Bootstrap: Using enp39s0:172.31.43.142<0>
2026-01-05 05:32:18,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO NCCL version 2.26.2+cuda12.2
2026-01-05 05:32:18,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m INFO 01-05 05:32:18 [__init__.py:1375] Found nccl from library libnccl.so.2
2026-01-05 05:32:18,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m INFO 01-05 05:32:18 [pynccl.py:70] vLLM is using nccl==2.26.2
2026-01-05 05:32:18,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO cudaDriverVersion 12020
2026-01-05 05:32:18,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Bootstrap: Using enp39s0:172.31.43.142<0>
2026-01-05 05:32:18,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO NCCL version 2.26.2+cuda12.2
2026-01-05 05:32:18,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m INFO 01-05 05:32:18 [__init__.py:1375] Found nccl from library libnccl.so.2
2026-01-05 05:32:18,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m INFO 01-05 05:32:18 [pynccl.py:70] vLLM is using nccl==2.26.2
2026-01-05 05:32:18,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Bootstrap: Using enp39s0:172.31.43.142<0>
2026-01-05 05:32:18,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO cudaDriverVersion 12020
2026-01-05 05:32:18,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO NCCL version 2.26.2+cuda12.2
2026-01-05 05:32:18,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
2026-01-05 05:32:18,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Failed to open libibverbs.so[.1]
2026-01-05 05:32:18,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO NET/Socket : Using [0]enp39s0:172.31.43.142<0>
2026-01-05 05:32:18,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO PROFILER/Plugin: Could not find: libnccl-profiler.so.
2026-01-05 05:32:18,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Using network Socket
2026-01-05 05:32:18,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO ncclCommInitRank comm 0xf4a47d0 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 38000 commId 0x3efc42d59627e986 - Init START
2026-01-05 05:32:18,449 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO RAS client listening socket at 127.0.0.1<28028>
2026-01-05 05:32:18,449 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Bootstrap timings total 0.000652 (create 0.000024, send 0.000090, recv 0.000254, ring 0.000047, delay 0.000000)
2026-01-05 05:32:18,449 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO NCCL_CUMEM_ENABLE set by environment to 0.
2026-01-05 05:32:18,449 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO NCCL_P2P_DISABLE set by environment to 1
2026-01-05 05:32:18,449 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Setting affinity for GPU 0 to ffff,ffffffff
2026-01-05 05:32:18,449 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO comm 0xf4a47d0 rank 0 nRanks 2 nNodes 1 localRanks 2 localRank 0 MNNVL 0
2026-01-05 05:32:18,449 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Channel 00/02 : 0 1
2026-01-05 05:32:18,449 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Channel 01/02 : 0 1
2026-01-05 05:32:18,449 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1
2026-01-05 05:32:18,449 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO P2P Chunksize set to 131072
2026-01-05 05:32:18,449 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Check P2P Type intraNodeP2pSupport 0 directMode 0
2026-01-05 05:32:18,449 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7849 [0] NCCL INFO [Proxy Service] Device 0 CPU core 16
2026-01-05 05:32:18,449 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7851 [0] NCCL INFO [Proxy Service UDS] Device 0 CPU core 15
2026-01-05 05:32:18,449 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
2026-01-05 05:32:18,449 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Failed to open libibverbs.so[.1]
2026-01-05 05:32:18,449 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO NET/Socket : Using [0]enp39s0:172.31.43.142<0>
2026-01-05 05:32:18,449 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO PROFILER/Plugin: Could not find: libnccl-profiler.so.
2026-01-05 05:32:18,449 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Using network Socket
2026-01-05 05:32:18,449 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO ncclCommInitRank comm 0x1097f9a0 rank 1 nranks 2 cudaDev 3 nvmlDev 3 busId 3e000 commId 0xb17bffd2cb685454 - Init START
2026-01-05 05:32:18,449 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO RAS client listening socket at 127.0.0.1<28028>
2026-01-05 05:32:18,449 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Bootstrap timings total 0.000586 (create 0.000024, send 0.000096, recv 0.000164, ring 0.000029, delay 0.000000)
2026-01-05 05:32:18,450 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO NCCL_CUMEM_ENABLE set by environment to 0.
2026-01-05 05:32:18,450 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO NCCL_P2P_DISABLE set by environment to 1
2026-01-05 05:32:18,450 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Setting affinity for GPU 3 to ffff,ffffffff
2026-01-05 05:32:18,450 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO comm 0x1097f9a0 rank 1 nRanks 2 nNodes 1 localRanks 2 localRank 1 MNNVL 0
2026-01-05 05:32:18,450 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] -1/-1/-1->1->0
2026-01-05 05:32:18,450 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO P2P Chunksize set to 131072
2026-01-05 05:32:18,450 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7844 [3] NCCL INFO [Proxy Service] Device 3 CPU core 40
2026-01-05 05:32:18,450 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7847 [3] NCCL INFO [Proxy Service UDS] Device 3 CPU core 33
2026-01-05 05:32:18,450 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
2026-01-05 05:32:18,450 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Failed to open libibverbs.so[.1]
2026-01-05 05:32:18,450 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO NET/Socket : Using [0]enp39s0:172.31.43.142<0>
2026-01-05 05:32:18,649 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO PROFILER/Plugin: Could not find: libnccl-profiler.so.
2026-01-05 05:32:18,649 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Using network Socket
2026-01-05 05:32:18,649 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO ncclCommInitRank comm 0x109464f0 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId 3a000 commId 0x3efc42d59627e986 - Init START
2026-01-05 05:32:18,649 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO RAS client listening socket at 127.0.0.1<28028>
2026-01-05 05:32:18,649 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Bootstrap timings total 0.005623 (create 0.000024, send 0.000104, recv 0.005103, ring 0.000029, delay 0.000000)
2026-01-05 05:32:18,649 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO NCCL_CUMEM_ENABLE set by environment to 0.
2026-01-05 05:32:18,650 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO NCCL_P2P_DISABLE set by environment to 1
2026-01-05 05:32:18,650 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Setting affinity for GPU 1 to ffff,ffffffff
2026-01-05 05:32:18,650 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO comm 0x109464f0 rank 1 nRanks 2 nNodes 1 localRanks 2 localRank 1 MNNVL 0
2026-01-05 05:32:18,650 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] -1/-1/-1->1->0
2026-01-05 05:32:18,650 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO P2P Chunksize set to 131072
2026-01-05 05:32:18,650 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7848 [1] NCCL INFO [Proxy Service] Device 1 CPU core 40
2026-01-05 05:32:18,650 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7850 [1] NCCL INFO [Proxy Service UDS] Device 1 CPU core 33
2026-01-05 05:32:18,650 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
2026-01-05 05:32:18,650 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Failed to open libibverbs.so[.1]
2026-01-05 05:32:18,650 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO NET/Socket : Using [0]enp39s0:172.31.43.142<0>
2026-01-05 05:32:18,650 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO PROFILER/Plugin: Could not find: libnccl-profiler.so.
2026-01-05 05:32:18,650 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Using network Socket
2026-01-05 05:32:18,650 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO ncclCommInitRank comm 0x10ceca30 rank 0 nranks 2 cudaDev 2 nvmlDev 2 busId 3c000 commId 0xb17bffd2cb685454 - Init START
2026-01-05 05:32:18,650 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO RAS client listening socket at 127.0.0.1<28028>
2026-01-05 05:32:18,650 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Bootstrap timings total 0.008755 (create 0.000056, send 0.000152, recv 0.008193, ring 0.000034, delay 0.000000)
2026-01-05 05:32:18,650 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO NCCL_CUMEM_ENABLE set by environment to 0.
2026-01-05 05:32:18,650 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO NCCL_P2P_DISABLE set by environment to 1
2026-01-05 05:32:18,650 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Setting affinity for GPU 2 to ffff,ffffffff
2026-01-05 05:32:18,650 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO comm 0x10ceca30 rank 0 nRanks 2 nNodes 1 localRanks 2 localRank 0 MNNVL 0
2026-01-05 05:32:18,650 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Channel 00/02 : 0 1
2026-01-05 05:32:18,651 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Channel 01/02 : 0 1
2026-01-05 05:32:18,651 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1
2026-01-05 05:32:18,651 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO P2P Chunksize set to 131072
2026-01-05 05:32:18,651 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Check P2P Type intraNodeP2pSupport 0 directMode 0
2026-01-05 05:32:18,651 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7846 [2] NCCL INFO [Proxy Service UDS] Device 2 CPU core 33
2026-01-05 05:32:18,651 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7845 [2] NCCL INFO [Proxy Service] Device 2 CPU core 40
2026-01-05 05:32:18,651 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Channel 00 : 0[0] -> 1[1] via SHM/direct/direct
2026-01-05 05:32:18,651 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Channel 01 : 0[0] -> 1[1] via SHM/direct/direct
2026-01-05 05:32:18,651 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
2026-01-05 05:32:18,651 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Connected all trees
2026-01-05 05:32:18,651 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7855 [0] NCCL INFO [Proxy Progress] Device 0 CPU core 41
2026-01-05 05:32:18,651 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
2026-01-05 05:32:18,651 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
2026-01-05 05:32:18,651 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO CC Off, workFifoBytes 1048576
2026-01-05 05:32:18,651 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
2026-01-05 05:32:18,651 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO ncclCommInitRank comm 0xf4a47d0 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 38000 commId 0x3efc42d59627e986 - Init COMPLETE
2026-01-05 05:32:18,651 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Init timings - ncclCommInitRank: rank 0 nranks 2 total 0.20 (kernels 0.14, alloc 0.00, bootstrap 0.00, allgathers 0.00, topo 0.00, graphs 0.00, connections 0.05, rest 0.00)
2026-01-05 05:32:18,651 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m INFO 01-05 05:32:18 [custom_all_reduce_utils.py:208] generating GPU P2P access cache in /home/ubuntu/.cache/vllm/gpu_p2p_access_cache_for_0,1,2,3.json
2026-01-05 05:32:18,651 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Channel 00 : 1[3] -> 0[2] via SHM/direct/direct
2026-01-05 05:32:18,651 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Channel 01 : 1[3] -> 0[2] via SHM/direct/direct
2026-01-05 05:32:18,652 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
2026-01-05 05:32:18,652 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Connected all trees
2026-01-05 05:32:18,652 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7852 [3] NCCL INFO [Proxy Progress] Device 3 CPU core 15
2026-01-05 05:32:18,652 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
2026-01-05 05:32:18,652 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
2026-01-05 05:32:18,652 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
2026-01-05 05:32:18,652 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO ncclCommInitRank comm 0x1097f9a0 rank 1 nranks 2 cudaDev 3 nvmlDev 3 busId 3e000 commId 0xb17bffd2cb685454 - Init COMPLETE
2026-01-05 05:32:18,652 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Init timings - ncclCommInitRank: rank 1 nranks 2 total 0.20 (kernels 0.14, alloc 0.00, bootstrap 0.00, allgathers 0.00, topo 0.01, graphs 0.00, connections 0.05, rest 0.00)
2026-01-05 05:32:18,652 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Channel 00 : 1[1] -> 0[0] via SHM/direct/direct
2026-01-05 05:32:18,652 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Channel 01 : 1[1] -> 0[0] via SHM/direct/direct
2026-01-05 05:32:18,652 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
2026-01-05 05:32:18,652 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Connected all trees
2026-01-05 05:32:18,652 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7854 [1] NCCL INFO [Proxy Progress] Device 1 CPU core 42
2026-01-05 05:32:18,652 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
2026-01-05 05:32:18,652 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
2026-01-05 05:32:18,652 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
2026-01-05 05:32:18,652 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO ncclCommInitRank comm 0x109464f0 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId 3a000 commId 0x3efc42d59627e986 - Init COMPLETE
2026-01-05 05:32:18,652 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Init timings - ncclCommInitRank: rank 1 nranks 2 total 0.20 (kernels 0.14, alloc 0.00, bootstrap 0.01, allgathers 0.00, topo 0.01, graphs 0.00, connections 0.05, rest 0.00)
2026-01-05 05:32:18,652 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Channel 00 : 0[2] -> 1[3] via SHM/direct/direct
2026-01-05 05:32:18,652 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Channel 01 : 0[2] -> 1[3] via SHM/direct/direct
2026-01-05 05:32:18,652 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
2026-01-05 05:32:18,653 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Connected all trees
2026-01-05 05:32:19,150 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7853 [2] NCCL INFO [Proxy Progress] Device 2 CPU core 15
2026-01-05 05:32:19,150 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
2026-01-05 05:32:19,150 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
2026-01-05 05:32:19,151 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO CC Off, workFifoBytes 1048576
2026-01-05 05:32:19,151 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
2026-01-05 05:32:19,151 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO ncclCommInitRank comm 0x10ceca30 rank 0 nranks 2 cudaDev 2 nvmlDev 2 busId 3c000 commId 0xb17bffd2cb685454 - Init COMPLETE
2026-01-05 05:32:19,151 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Init timings - ncclCommInitRank: rank 0 nranks 2 total 0.20 (kernels 0.14, alloc 0.00, bootstrap 0.01, allgathers 0.00, topo 0.01, graphs 0.00, connections 0.05, rest 0.00)
2026-01-05 05:32:28,888 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m INFO 01-05 05:32:28 [custom_all_reduce_utils.py:246] reading GPU P2P access cache from /home/ubuntu/.cache/vllm/gpu_p2p_access_cache_for_0,1,2,3.json
2026-01-05 05:32:28,888 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m WARNING 01-05 05:32:28 [custom_all_reduce.py:147] Custom allreduce is disabled because your platform lacks GPU P2P capability or P2P test failed. To silence this warning, specify disable_custom_all_reduce=True explicitly.
2026-01-05 05:32:28,888 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m INFO 01-05 05:32:28 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[1], buffer_handle=(1, 4194304, 6, 'psm_be395691'), local_subscribe_addr='ipc:///tmp/d47de63a-4954-4a96-ba7f-46f2fe9a046b', remote_subscribe_addr=None, remote_addr_ipv6=False)
2026-01-05 05:32:28,888 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m INFO 01-05 05:32:28 [__init__.py:1375] Found nccl from library libnccl.so.2
2026-01-05 05:32:28,888 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m INFO 01-05 05:32:28 [pynccl.py:70] vLLM is using nccl==2.26.2
2026-01-05 05:32:28,888 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Using network Socket
2026-01-05 05:32:28,888 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO ncclCommInitRank comm 0x1292d670 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 38000 commId 0x2be621e7b34c05e3 - Init START
2026-01-05 05:32:28,888 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Bootstrap timings total 0.000519 (create 0.000021, send 0.000086, recv 0.000255, ring 0.000021, delay 0.000000)
2026-01-05 05:32:28,889 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Setting affinity for GPU 0 to ffff,ffffffff
2026-01-05 05:32:28,889 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO comm 0x1292d670 rank 0 nRanks 2 nNodes 1 localRanks 2 localRank 0 MNNVL 0
2026-01-05 05:32:28,889 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Channel 00/02 : 0 1
2026-01-05 05:32:28,889 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Channel 01/02 : 0 1
2026-01-05 05:32:28,889 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1
2026-01-05 05:32:28,889 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO P2P Chunksize set to 131072
2026-01-05 05:32:28,889 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Check P2P Type intraNodeP2pSupport 0 directMode 0
2026-01-05 05:32:28,889 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7949 [0] NCCL INFO [Proxy Service] Device 0 CPU core 37
2026-01-05 05:32:28,889 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7951 [0] NCCL INFO [Proxy Service UDS] Device 0 CPU core 15
2026-01-05 05:32:28,889 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Channel 00 : 0[0] -> 1[2] via SHM/direct/direct
2026-01-05 05:32:28,889 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Channel 01 : 0[0] -> 1[2] via SHM/direct/direct
2026-01-05 05:32:28,889 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
2026-01-05 05:32:28,889 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Connected all trees
2026-01-05 05:32:28,889 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7953 [0] NCCL INFO [Proxy Progress] Device 0 CPU core 9
2026-01-05 05:32:28,889 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
2026-01-05 05:32:28,889 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
2026-01-05 05:32:28,889 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO CC Off, workFifoBytes 1048576
2026-01-05 05:32:28,889 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO ncclCommInitRank comm 0x1292d670 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 38000 commId 0x2be621e7b34c05e3 - Init COMPLETE
2026-01-05 05:32:28,889 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Init timings - ncclCommInitRank: rank 0 nranks 2 total 0.06 (kernels 0.00, alloc 0.00, bootstrap 0.00, allgathers 0.00, topo 0.01, graphs 0.00, connections 0.05, rest 0.00)
2026-01-05 05:32:28,889 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m INFO 01-05 05:32:28 [parallel_state.py:1102] rank 0 in world size 4 is assigned as DP rank 0, PP rank 0, TP rank 0, EP rank 0
2026-01-05 05:32:28,890 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m WARNING 01-05 05:32:28 [topk_topp_sampler.py:59] FlashInfer is not available. Falling back to the PyTorch-native implementation of top-p & top-k sampling. For the best performance, please install FlashInfer.
2026-01-05 05:32:28,890 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m INFO 01-05 05:32:28 [custom_all_reduce_utils.py:246] reading GPU P2P access cache from /home/ubuntu/.cache/vllm/gpu_p2p_access_cache_for_0,1,2,3.json
2026-01-05 05:32:28,890 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m WARNING 01-05 05:32:28 [custom_all_reduce.py:147] Custom allreduce is disabled because your platform lacks GPU P2P capability or P2P test failed. To silence this warning, specify disable_custom_all_reduce=True explicitly.
2026-01-05 05:32:28,890 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m INFO 01-05 05:32:28 [__init__.py:1375] Found nccl from library libnccl.so.2
2026-01-05 05:32:28,890 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m INFO 01-05 05:32:28 [pynccl.py:70] vLLM is using nccl==2.26.2
2026-01-05 05:32:28,890 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Using network Socket
2026-01-05 05:32:28,890 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO ncclCommInitRank comm 0x13e20de0 rank 1 nranks 2 cudaDev 3 nvmlDev 3 busId 3e000 commId 0xe16e41c910c006ee - Init START
2026-01-05 05:32:28,890 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Bootstrap timings total 0.000505 (create 0.000022, send 0.000090, recv 0.000152, ring 0.000030, delay 0.000000)
2026-01-05 05:32:28,890 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Setting affinity for GPU 3 to ffff,ffffffff
2026-01-05 05:32:28,890 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO comm 0x13e20de0 rank 1 nRanks 2 nNodes 1 localRanks 2 localRank 1 MNNVL 0
2026-01-05 05:32:28,890 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] -1/-1/-1->1->0
2026-01-05 05:32:28,890 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO P2P Chunksize set to 131072
2026-01-05 05:32:28,890 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7946 [3] NCCL INFO [Proxy Service] Device 3 CPU core 15
2026-01-05 05:32:28,890 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7948 [3] NCCL INFO [Proxy Service UDS] Device 3 CPU core 43
2026-01-05 05:32:28,890 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Channel 00 : 1[3] -> 0[1] via SHM/direct/direct
2026-01-05 05:32:28,890 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Channel 01 : 1[3] -> 0[1] via SHM/direct/direct
2026-01-05 05:32:28,890 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
2026-01-05 05:32:28,890 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Connected all trees
2026-01-05 05:32:28,890 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7955 [3] NCCL INFO [Proxy Progress] Device 3 CPU core 41
2026-01-05 05:32:28,890 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
2026-01-05 05:32:28,891 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
2026-01-05 05:32:28,891 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO ncclCommInitRank comm 0x13e20de0 rank 1 nranks 2 cudaDev 3 nvmlDev 3 busId 3e000 commId 0xe16e41c910c006ee - Init COMPLETE
2026-01-05 05:32:28,891 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Init timings - ncclCommInitRank: rank 1 nranks 2 total 0.06 (kernels 0.00, alloc 0.00, bootstrap 0.00, allgathers 0.00, topo 0.01, graphs 0.00, connections 0.05, rest 0.00)
2026-01-05 05:32:28,891 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m INFO 01-05 05:32:28 [parallel_state.py:1102] rank 3 in world size 4 is assigned as DP rank 0, PP rank 1, TP rank 1, EP rank 1
2026-01-05 05:32:28,891 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m WARNING 01-05 05:32:28 [topk_topp_sampler.py:59] FlashInfer is not available. Falling back to the PyTorch-native implementation of top-p & top-k sampling. For the best performance, please install FlashInfer.
2026-01-05 05:32:28,891 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m INFO 01-05 05:32:28 [custom_all_reduce_utils.py:246] reading GPU P2P access cache from /home/ubuntu/.cache/vllm/gpu_p2p_access_cache_for_0,1,2,3.json
2026-01-05 05:32:28,891 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m WARNING 01-05 05:32:28 [custom_all_reduce.py:147] Custom allreduce is disabled because your platform lacks GPU P2P capability or P2P test failed. To silence this warning, specify disable_custom_all_reduce=True explicitly.
2026-01-05 05:32:28,891 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m INFO 01-05 05:32:28 [__init__.py:1375] Found nccl from library libnccl.so.2
2026-01-05 05:32:28,891 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m INFO 01-05 05:32:28 [pynccl.py:70] vLLM is using nccl==2.26.2
2026-01-05 05:32:28,891 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Using network Socket
2026-01-05 05:32:28,891 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO ncclCommInitRank comm 0x13de7670 rank 0 nranks 2 cudaDev 1 nvmlDev 1 busId 3a000 commId 0xe16e41c910c006ee - Init START
2026-01-05 05:32:28,891 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Bootstrap timings total 0.000470 (create 0.000022, send 0.000084, recv 0.000205, ring 0.000025, delay 0.000000)
2026-01-05 05:32:28,891 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Setting affinity for GPU 1 to ffff,ffffffff
2026-01-05 05:32:28,891 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO comm 0x13de7670 rank 0 nRanks 2 nNodes 1 localRanks 2 localRank 0 MNNVL 0
2026-01-05 05:32:28,891 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Channel 00/02 : 0 1
2026-01-05 05:32:28,891 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Channel 01/02 : 0 1
2026-01-05 05:32:28,891 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1
2026-01-05 05:32:28,891 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO P2P Chunksize set to 131072
2026-01-05 05:32:28,891 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Check P2P Type intraNodeP2pSupport 0 directMode 0
2026-01-05 05:32:28,891 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7945 [1] NCCL INFO [Proxy Service] Device 1 CPU core 39
2026-01-05 05:32:28,891 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7947 [1] NCCL INFO [Proxy Service UDS] Device 1 CPU core 42
2026-01-05 05:32:28,892 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Channel 00 : 0[1] -> 1[3] via SHM/direct/direct
2026-01-05 05:32:28,892 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Channel 01 : 0[1] -> 1[3] via SHM/direct/direct
2026-01-05 05:32:28,892 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
2026-01-05 05:32:28,892 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Connected all trees
2026-01-05 05:32:28,892 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7954 [1] NCCL INFO [Proxy Progress] Device 1 CPU core 42
2026-01-05 05:32:28,892 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
2026-01-05 05:32:28,892 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
2026-01-05 05:32:28,892 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO CC Off, workFifoBytes 1048576
2026-01-05 05:32:28,892 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO ncclCommInitRank comm 0x13de7670 rank 0 nranks 2 cudaDev 1 nvmlDev 1 busId 3a000 commId 0xe16e41c910c006ee - Init COMPLETE
2026-01-05 05:32:28,892 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Init timings - ncclCommInitRank: rank 0 nranks 2 total 0.06 (kernels 0.00, alloc 0.00, bootstrap 0.00, allgathers 0.00, topo 0.01, graphs 0.00, connections 0.05, rest 0.00)
2026-01-05 05:32:28,892 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m INFO 01-05 05:32:28 [parallel_state.py:1102] rank 1 in world size 4 is assigned as DP rank 0, PP rank 0, TP rank 1, EP rank 1
2026-01-05 05:32:28,892 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m WARNING 01-05 05:32:28 [topk_topp_sampler.py:59] FlashInfer is not available. Falling back to the PyTorch-native implementation of top-p & top-k sampling. For the best performance, please install FlashInfer.
2026-01-05 05:32:28,892 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m INFO 01-05 05:32:28 [custom_all_reduce_utils.py:246] reading GPU P2P access cache from /home/ubuntu/.cache/vllm/gpu_p2p_access_cache_for_0,1,2,3.json
2026-01-05 05:32:28,892 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m WARNING 01-05 05:32:28 [custom_all_reduce.py:147] Custom allreduce is disabled because your platform lacks GPU P2P capability or P2P test failed. To silence this warning, specify disable_custom_all_reduce=True explicitly.
2026-01-05 05:32:28,892 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m INFO 01-05 05:32:28 [shm_broadcast.py:289] vLLM message queue communication handle: Handle(local_reader_ranks=[1], buffer_handle=(1, 4194304, 6, 'psm_8ba44fdd'), local_subscribe_addr='ipc:///tmp/6b7ba5cd-9173-4051-92b1-774710366052', remote_subscribe_addr=None, remote_addr_ipv6=False)
2026-01-05 05:32:28,892 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m INFO 01-05 05:32:28 [__init__.py:1375] Found nccl from library libnccl.so.2
2026-01-05 05:32:28,892 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m INFO 01-05 05:32:28 [pynccl.py:70] vLLM is using nccl==2.26.2
2026-01-05 05:32:28,892 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Using network Socket
2026-01-05 05:32:28,892 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO ncclCommInitRank comm 0x14188150 rank 1 nranks 2 cudaDev 2 nvmlDev 2 busId 3c000 commId 0x2be621e7b34c05e3 - Init START
2026-01-05 05:32:28,892 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Bootstrap timings total 0.000521 (create 0.000022, send 0.000098, recv 0.000169, ring 0.000032, delay 0.000000)
2026-01-05 05:32:28,893 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Setting affinity for GPU 2 to ffff,ffffffff
2026-01-05 05:32:28,893 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO comm 0x14188150 rank 1 nRanks 2 nNodes 1 localRanks 2 localRank 1 MNNVL 0
2026-01-05 05:32:28,893 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] -1/-1/-1->1->0
2026-01-05 05:32:28,893 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO P2P Chunksize set to 131072
2026-01-05 05:32:29,792 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7950 [2] NCCL INFO [Proxy Service] Device 2 CPU core 43
2026-01-05 05:32:29,792 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7952 [2] NCCL INFO [Proxy Service UDS] Device 2 CPU core 42
2026-01-05 05:32:29,792 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Channel 00 : 1[2] -> 0[0] via SHM/direct/direct
2026-01-05 05:32:29,792 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Channel 01 : 1[2] -> 0[0] via SHM/direct/direct
2026-01-05 05:32:29,792 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
2026-01-05 05:32:29,792 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Connected all trees
2026-01-05 05:32:29,792 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7956 [2] NCCL INFO [Proxy Progress] Device 2 CPU core 41
2026-01-05 05:32:29,793 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
2026-01-05 05:32:29,793 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
2026-01-05 05:32:29,793 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO ncclCommInitRank comm 0x14188150 rank 1 nranks 2 cudaDev 2 nvmlDev 2 busId 3c000 commId 0x2be621e7b34c05e3 - Init COMPLETE
2026-01-05 05:32:29,793 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Init timings - ncclCommInitRank: rank 1 nranks 2 total 0.06 (kernels 0.00, alloc 0.00, bootstrap 0.00, allgathers 0.00, topo 0.01, graphs 0.00, connections 0.05, rest 0.00)
2026-01-05 05:32:29,793 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m INFO 01-05 05:32:28 [parallel_state.py:1102] rank 2 in world size 4 is assigned as DP rank 0, PP rank 1, TP rank 0, EP rank 0
2026-01-05 05:32:29,793 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m WARNING 01-05 05:32:28 [topk_topp_sampler.py:59] FlashInfer is not available. Falling back to the PyTorch-native implementation of top-p & top-k sampling. For the best performance, please install FlashInfer.
2026-01-05 05:32:29,793 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m INFO 01-05 05:32:28 [gpu_model_runner.py:1843] Starting to load model deepseek-ai/DeepSeek-R1-Distill-Llama-70B...
2026-01-05 05:32:29,793 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m INFO 01-05 05:32:28 [gpu_model_runner.py:1843] Starting to load model deepseek-ai/DeepSeek-R1-Distill-Llama-70B...
2026-01-05 05:32:29,793 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m INFO 01-05 05:32:28 [gpu_model_runner.py:1843] Starting to load model deepseek-ai/DeepSeek-R1-Distill-Llama-70B...
2026-01-05 05:32:29,793 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m INFO 01-05 05:32:28 [gpu_model_runner.py:1843] Starting to load model deepseek-ai/DeepSeek-R1-Distill-Llama-70B...
2026-01-05 05:32:29,793 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m INFO 01-05 05:32:28 [gpu_model_runner.py:1875] Loading model from scratch...
2026-01-05 05:32:29,793 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m INFO 01-05 05:32:28 [gpu_model_runner.py:1875] Loading model from scratch...
2026-01-05 05:32:29,793 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m INFO 01-05 05:32:28 [gpu_model_runner.py:1875] Loading model from scratch...
2026-01-05 05:32:29,793 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m INFO 01-05 05:32:28 [gpu_model_runner.py:1875] Loading model from scratch...
2026-01-05 05:32:29,793 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m INFO 01-05 05:32:29 [cuda.py:290] Using Flash Attention backend on V1 engine.
2026-01-05 05:32:29,793 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m INFO 01-05 05:32:29 [cuda.py:290] Using Flash Attention backend on V1 engine.
2026-01-05 05:32:29,793 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m INFO 01-05 05:32:29 [cuda.py:290] Using Flash Attention backend on V1 engine.
2026-01-05 05:32:29,793 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m INFO 01-05 05:32:28 [cuda.py:290] Using Flash Attention backend on V1 engine.
2026-01-05 05:32:29,793 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m INFO 01-05 05:32:29 [weight_utils.py:296] Using model weights format ['*.safetensors']
2026-01-05 05:32:29,793 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m INFO 01-05 05:32:29 [weight_utils.py:296] Using model weights format ['*.safetensors']
2026-01-05 05:32:29,794 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m INFO 01-05 05:32:29 [weight_utils.py:296] Using model weights format ['*.safetensors']
2026-01-05 05:32:29,794 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m INFO 01-05 05:32:29 [weight_utils.py:296] Using model weights format ['*.safetensors']
2026-01-05 05:32:40,025 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [2026-01-05 05:32:40,005 E 7346 7380] core_worker_process.cc:842: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
2026-01-05 05:32:41,029 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m [2026-01-05 05:32:40,747 E 7462 7524] core_worker_process.cc:842: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
2026-01-05 05:32:41,029 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m [2026-01-05 05:32:40,752 E 7463 7573] core_worker_process.cc:842: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
2026-01-05 05:32:41,029 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m [2026-01-05 05:32:40,777 E 7465 7650] core_worker_process.cc:842: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
2026-01-05 05:32:41,029 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m [2026-01-05 05:32:40,780 E 7464 7605] core_worker_process.cc:842: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
2026-01-05 05:38:06,982 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m INFO 01-05 05:38:06 [weight_utils.py:312] Time spent downloading weights for deepseek-ai/DeepSeek-R1-Distill-Llama-70B: 337.662601 seconds
2026-01-05 05:38:07,685 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m
2026-01-05 05:38:07,685 - INFO - Loading safetensors checkpoint shards:   0% Completed | 0/17 [00:00<?, ?it/s]
2026-01-05 05:38:08,791 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m
2026-01-05 05:38:08,791 - INFO - Loading safetensors checkpoint shards:  12% Completed | 2/17 [00:01<00:10,  1.48it/s]
2026-01-05 05:38:09,492 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m
2026-01-05 05:38:09,492 - INFO - Loading safetensors checkpoint shards:  18% Completed | 3/17 [00:01<00:08,  1.74it/s]
2026-01-05 05:38:10,395 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m
2026-01-05 05:38:10,395 - INFO - Loading safetensors checkpoint shards:  24% Completed | 4/17 [00:03<00:11,  1.14it/s]
2026-01-05 05:38:11,098 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m
2026-01-05 05:38:11,098 - INFO - Loading safetensors checkpoint shards:  29% Completed | 5/17 [00:03<00:07,  1.58it/s]
2026-01-05 05:38:11,801 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m
2026-01-05 05:38:11,801 - INFO - Loading safetensors checkpoint shards:  47% Completed | 8/17 [00:04<00:04,  1.99it/s]
2026-01-05 05:38:12,504 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m
2026-01-05 05:38:12,505 - INFO - Loading safetensors checkpoint shards:  53% Completed | 9/17 [00:04<00:03,  2.33it/s]
2026-01-05 05:38:13,407 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m
2026-01-05 05:38:13,407 - INFO - Loading safetensors checkpoint shards:  59% Completed | 10/17 [00:06<00:04,  1.54it/s]
2026-01-05 05:38:15,013 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m
2026-01-05 05:38:15,013 - INFO - Loading safetensors checkpoint shards:  65% Completed | 11/17 [00:07<00:05,  1.15it/s]
2026-01-05 05:38:15,714 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m
2026-01-05 05:38:15,714 - INFO - Loading safetensors checkpoint shards:  71% Completed | 12/17 [00:07<00:03,  1.46it/s]
2026-01-05 05:38:16,419 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m
2026-01-05 05:38:16,419 - INFO - Loading safetensors checkpoint shards:  76% Completed | 13/17 [00:09<00:03,  1.16it/s]
2026-01-05 05:38:17,122 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m
2026-01-05 05:38:17,122 - INFO - Loading safetensors checkpoint shards:  82% Completed | 14/17 [00:09<00:02,  1.49it/s]
2026-01-05 05:38:17,827 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m
2026-01-05 05:38:17,827 - INFO - Loading safetensors checkpoint shards:  88% Completed | 15/17 [00:10<00:01,  1.16it/s]
2026-01-05 05:38:18,529 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m
2026-01-05 05:38:18,529 - INFO - Loading safetensors checkpoint shards:  94% Completed | 16/17 [00:10<00:00,  1.52it/s]
2026-01-05 05:38:19,431 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m
2026-01-05 05:38:19,431 - INFO - Loading safetensors checkpoint shards: 100% Completed | 17/17 [00:12<00:00,  1.14it/s]
2026-01-05 05:38:19,431 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m
2026-01-05 05:38:19,431 - INFO - Loading safetensors checkpoint shards: 100% Completed | 17/17 [00:12<00:00,  1.39it/s]
2026-01-05 05:38:19,432 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m
2026-01-05 05:38:20,032 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m INFO 01-05 05:38:19 [default_loader.py:262] Loading weights took 12.34 seconds
2026-01-05 05:38:20,032 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m INFO 01-05 05:38:19 [default_loader.py:262] Loading weights took 12.48 seconds
2026-01-05 05:38:20,032 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m INFO 01-05 05:38:19 [default_loader.py:262] Loading weights took 12.56 seconds
2026-01-05 05:38:20,032 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m INFO 01-05 05:38:19 [gpu_model_runner.py:1892] Model loading took 32.8861 GiB and 350.437475 seconds
2026-01-05 05:38:20,032 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m INFO 01-05 05:38:19 [default_loader.py:262] Loading weights took 12.53 seconds
2026-01-05 05:38:20,032 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m INFO 01-05 05:38:19 [gpu_model_runner.py:1892] Model loading took 32.8861 GiB and 350.486057 seconds
2026-01-05 05:38:20,935 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m INFO 01-05 05:38:19 [gpu_model_runner.py:1892] Model loading took 32.8861 GiB and 350.507523 seconds
2026-01-05 05:38:20,935 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m INFO 01-05 05:38:20 [gpu_model_runner.py:1892] Model loading took 32.8861 GiB and 350.876705 seconds
2026-01-05 05:38:24,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Comm config Blocking set to 1
2026-01-05 05:38:24,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:8922 [3] NCCL INFO Using network Socket
2026-01-05 05:38:24,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:8922 [3] NCCL INFO ncclCommInitRankConfig comm 0x28e7c170 rank 1 nranks 2 cudaDev 3 nvmlDev 3 busId 3e000 commId 0x6caf977c57f54f5 - Init START
2026-01-05 05:38:24,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:8922 [3] NCCL INFO Bootstrap timings total 0.000558 (create 0.000024, send 0.000133, recv 0.000151, ring 0.000032, delay 0.000000)
2026-01-05 05:38:24,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:8922 [3] NCCL INFO Setting affinity for GPU 3 to ffff,ffffffff
2026-01-05 05:38:24,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:8922 [3] NCCL INFO comm 0x28e7c170 rank 1 nRanks 2 nNodes 1 localRanks 2 localRank 1 MNNVL 0
2026-01-05 05:38:24,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:8922 [3] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] -1/-1/-1->1->0
2026-01-05 05:38:24,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:8922 [3] NCCL INFO P2P Chunksize set to 131072
2026-01-05 05:38:24,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:8925 [3] NCCL INFO [Proxy Service UDS] Device 3 CPU core 10
2026-01-05 05:38:24,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:8923 [3] NCCL INFO [Proxy Service] Device 3 CPU core 24
2026-01-05 05:38:24,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:8922 [3] NCCL INFO Channel 00 : 1[3] -> 0[2] via SHM/direct/direct
2026-01-05 05:38:24,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:8922 [3] NCCL INFO Channel 01 : 1[3] -> 0[2] via SHM/direct/direct
2026-01-05 05:38:24,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:8922 [3] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
2026-01-05 05:38:24,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:8922 [3] NCCL INFO Connected all trees
2026-01-05 05:38:24,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:8927 [3] NCCL INFO [Proxy Progress] Device 3 CPU core 47
2026-01-05 05:38:24,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:8922 [3] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
2026-01-05 05:38:24,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:8922 [3] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
2026-01-05 05:38:24,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:8922 [3] NCCL INFO ncclCommInitRankConfig comm 0x28e7c170 rank 1 nranks 2 cudaDev 3 nvmlDev 3 busId 3e000 commId 0x6caf977c57f54f5 - Init COMPLETE
2026-01-05 05:38:24,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:8922 [3] NCCL INFO Init timings - ncclCommInitRankConfig: rank 1 nranks 2 total 0.07 (kernels 0.00, alloc 0.00, bootstrap 0.00, allgathers 0.00, topo 0.00, graphs 0.00, connections 0.07, rest 0.00)
2026-01-05 05:38:24,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Comm config Blocking set to 1
2026-01-05 05:38:24,448 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:8921 [2] NCCL INFO Using network Socket
2026-01-05 05:38:24,950 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:8921 [2] NCCL INFO ncclCommInitRankConfig comm 0x291ddb00 rank 0 nranks 2 cudaDev 2 nvmlDev 2 busId 3c000 commId 0x6caf977c57f54f5 - Init START
2026-01-05 05:38:24,950 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:8921 [2] NCCL INFO Bootstrap timings total 0.000580 (create 0.000030, send 0.000148, recv 0.000238, ring 0.000025, delay 0.000000)
2026-01-05 05:38:24,951 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:8921 [2] NCCL INFO Setting affinity for GPU 2 to ffff,ffffffff
2026-01-05 05:38:24,951 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:8921 [2] NCCL INFO comm 0x291ddb00 rank 0 nRanks 2 nNodes 1 localRanks 2 localRank 0 MNNVL 0
2026-01-05 05:38:24,951 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:8921 [2] NCCL INFO Channel 00/02 : 0 1
2026-01-05 05:38:24,951 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:8921 [2] NCCL INFO Channel 01/02 : 0 1
2026-01-05 05:38:24,951 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:8921 [2] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1
2026-01-05 05:38:24,951 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:8921 [2] NCCL INFO P2P Chunksize set to 131072
2026-01-05 05:38:24,951 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:8921 [2] NCCL INFO Check P2P Type intraNodeP2pSupport 0 directMode 0
2026-01-05 05:38:24,951 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:8924 [2] NCCL INFO [Proxy Service] Device 2 CPU core 25
2026-01-05 05:38:24,951 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:8926 [2] NCCL INFO [Proxy Service UDS] Device 2 CPU core 19
2026-01-05 05:38:24,951 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:8921 [2] NCCL INFO Channel 00 : 0[2] -> 1[3] via SHM/direct/direct
2026-01-05 05:38:24,951 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:8921 [2] NCCL INFO Channel 01 : 0[2] -> 1[3] via SHM/direct/direct
2026-01-05 05:38:24,951 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:8921 [2] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
2026-01-05 05:38:24,951 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:8921 [2] NCCL INFO Connected all trees
2026-01-05 05:38:24,951 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:8928 [2] NCCL INFO [Proxy Progress] Device 2 CPU core 24
2026-01-05 05:38:24,951 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:8921 [2] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
2026-01-05 05:38:24,951 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:8921 [2] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
2026-01-05 05:38:24,951 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:8921 [2] NCCL INFO CC Off, workFifoBytes 1048576
2026-01-05 05:38:24,951 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:8921 [2] NCCL INFO ncclCommInitRankConfig comm 0x291ddb00 rank 0 nranks 2 cudaDev 2 nvmlDev 2 busId 3c000 commId 0x6caf977c57f54f5 - Init COMPLETE
2026-01-05 05:38:24,951 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:8921 [2] NCCL INFO Init timings - ncclCommInitRankConfig: rank 0 nranks 2 total 0.08 (kernels 0.00, alloc 0.00, bootstrap 0.00, allgathers 0.00, topo 0.00, graphs 0.00, connections 0.07, rest 0.00)
2026-01-05 05:38:25,754 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m INFO 01-05 05:38:25 [gpu_worker.py:255] Available KV cache memory: 3.27 GiB
2026-01-05 05:38:25,754 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m INFO 01-05 05:38:25 [gpu_worker.py:255] Available KV cache memory: 3.27 GiB
2026-01-05 05:38:27,061 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m INFO 01-05 05:38:26 [gpu_worker.py:255] Available KV cache memory: 3.81 GiB
2026-01-05 05:38:27,061 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m INFO 01-05 05:38:26 [gpu_worker.py:255] Available KV cache memory: 3.81 GiB
2026-01-05 05:38:27,966 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m INFO 01-05 05:38:27 [kv_cache_utils.py:833] GPU KV cache size: 49,872 tokens
2026-01-05 05:38:27,966 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m INFO 01-05 05:38:27 [kv_cache_utils.py:837] Maximum concurrency for 2,559 tokens per request: 19.48x
2026-01-05 05:38:27,966 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m INFO 01-05 05:38:27 [kv_cache_utils.py:833] GPU KV cache size: 49,872 tokens
2026-01-05 05:38:27,966 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m INFO 01-05 05:38:27 [kv_cache_utils.py:837] Maximum concurrency for 2,559 tokens per request: 19.48x
2026-01-05 05:38:27,966 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m INFO 01-05 05:38:27 [kv_cache_utils.py:833] GPU KV cache size: 42,800 tokens
2026-01-05 05:38:27,966 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m INFO 01-05 05:38:27 [kv_cache_utils.py:837] Maximum concurrency for 2,559 tokens per request: 16.72x
2026-01-05 05:38:27,966 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m INFO 01-05 05:38:27 [kv_cache_utils.py:833] GPU KV cache size: 42,800 tokens
2026-01-05 05:38:27,966 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m INFO 01-05 05:38:27 [kv_cache_utils.py:837] Maximum concurrency for 2,559 tokens per request: 16.72x
2026-01-05 05:38:27,966 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m INFO 01-05 05:38:27 [core.py:193] init engine (profile, create kv cache, warmup model) took 7.08 seconds
2026-01-05 05:38:28,469 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m INFO 01-05 05:38:27 [core.py:133] Batch queue is enabled with size 2
2026-01-05 05:38:28,469 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m üì° Attempting distributed GPU monitoring across Ray cluster...
2026-01-05 05:38:28,469 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m    Connecting to Ray cluster at 127.0.0.1:6379...
2026-01-05 05:38:28,469 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m 2026-01-05 05:38:27,903	INFO worker.py:1821 -- Connecting to existing Ray cluster at address: 172.31.43.142:6379...
2026-01-05 05:38:28,469 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m 2026-01-05 05:38:27,914	INFO worker.py:2007 -- Connected to Ray cluster.
2026-01-05 05:38:28,469 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m    ‚úÖ Connected to Ray cluster
2026-01-05 05:38:28,469 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m    Ray cluster detected: 1 alive nodes
2026-01-05 05:38:28,469 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m       Node 0: 0f5204c99bc4d3dda71d5f6e4a41ae54749bc920a52413e725288ac4
2026-01-05 05:38:28,469 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ‚úÖ Distributed GPU monitoring initialized successfully
2026-01-05 05:38:28,469 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m üìä vLLM Config: {'block_size': 16, 'gpu_memory_utilization': 0.85, 'num_gpu_blocks': 2675, 'num_cpu_blocks': None, 'swap_space': 4.0, 'cache_dtype': 'auto', 'kv_cache_dtype': None, 'dtype': 'torch.bfloat16', 'max_model_len': 2559, 'quantization': None, 'quantization_param_path': None, 'enforce_eager': True, 'max_seq_len_to_capture': 2559, 'lmcache_enabled': False, 'kv_transfer_config_enabled': False, 'enable_prefix_caching': None, 'enable_chunked_prefill': None, 'trust_remote_code': None}
2026-01-05 05:38:30,577 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m
2026-01-05 05:38:30,577 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m Generating test split:   0%|          | 0/100 [00:00<?, ? examples/s]
2026-01-05 05:38:30,577 - INFO - Generating test split: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [00:00<00:00, 451.25 examples/s]
2026-01-05 05:38:30,577 - INFO - Generating test split: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 100/100 [00:00<00:00, 362.70 examples/s]
2026-01-05 05:38:30,577 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m Token indices sequence length is longer than the specified maximum sequence length for this model (57163 > 16384). Running this sequence through the model will result in indexing errors
2026-01-05 05:38:35,492 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m üî• Running warmup with 5 samples...
2026-01-05 05:38:35,492 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m
2026-01-05 05:38:35,493 - INFO - Adding requests:   0%|          | 0/5 [00:00<?, ?it/s]INFO 01-05 05:38:35 [ray_distributed_executor.py:550] RAY_CGRAPH_get_timeout is set to 300
2026-01-05 05:38:35,493 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m INFO 01-05 05:38:35 [ray_distributed_executor.py:552] VLLM_USE_RAY_COMPILED_DAG_CHANNEL_TYPE = auto
2026-01-05 05:38:35,493 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m INFO 01-05 05:38:35 [ray_distributed_executor.py:554] VLLM_USE_RAY_COMPILED_DAG_OVERLAP_COMM = False
2026-01-05 05:38:35,493 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m
2026-01-05 05:38:35,493 - INFO - Adding requests: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 5/5 [00:00<00:00, 286.24it/s]
2026-01-05 05:38:36,095 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m
2026-01-05 05:38:36,096 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m Processed prompts:   0%|          | 0/5 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]2026-01-05 05:38:35,711	INFO torch_tensor_accelerator_channel.py:807 -- Creating communicator group edcb1ebc-c0e6-47c8-bd7d-43ecbdb3b430 on actors: [Actor(RayWorkerWrapper, e83f280b8d4bfad068e9f5f201000000), Actor(RayWorkerWrapper, a123796a09070f375575731a01000000), Actor(RayWorkerWrapper, 6953297b569eaedc40acd59d01000000), Actor(RayWorkerWrapper, d96094d322bf25f94c1af79301000000)]
2026-01-05 05:38:36,096 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Using network Socket
2026-01-05 05:38:36,096 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO ncclCommInitRank comm 0x2ac57d40 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 38000 commId 0x780d50bf49488d46 - Init START
2026-01-05 05:38:36,096 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Using network Socket
2026-01-05 05:38:36,096 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO ncclCommInitRank comm 0x32c81360 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId 3e000 commId 0x780d50bf49488d46 - Init START
2026-01-05 05:38:36,096 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Using network Socket
2026-01-05 05:38:36,096 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO ncclCommInitRank comm 0x2bfcb010 rank 2 nranks 4 cudaDev 1 nvmlDev 1 busId 3a000 commId 0x780d50bf49488d46 - Init START
2026-01-05 05:38:36,096 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Bootstrap timings total 0.118964 (create 0.000036, send 0.000181, recv 0.118419, ring 0.000145, delay 0.000000)
2026-01-05 05:38:36,096 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Setting affinity for GPU 0 to ffff,ffffffff
2026-01-05 05:38:36,096 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO NVLS multicast support is not available on dev 0
2026-01-05 05:38:36,096 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO comm 0x2ac57d40 rank 0 nRanks 4 nNodes 1 localRanks 4 localRank 0 MNNVL 0
2026-01-05 05:38:36,096 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Channel 00/02 : 0 1 2 3
2026-01-05 05:38:36,096 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Channel 01/02 : 0 1 2 3
2026-01-05 05:38:36,096 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1
2026-01-05 05:38:36,096 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO P2P Chunksize set to 131072
2026-01-05 05:38:36,096 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Check P2P Type intraNodeP2pSupport 0 directMode 0
2026-01-05 05:38:36,096 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:9163 [0] NCCL INFO [Proxy Service] Device 0 CPU core 44
2026-01-05 05:38:36,096 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:9167 [0] NCCL INFO [Proxy Service UDS] Device 0 CPU core 40
2026-01-05 05:38:36,096 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Bootstrap timings total 0.051153 (create 0.000035, send 0.000117, recv 0.000172, ring 0.050540, delay 0.000000)
2026-01-05 05:38:36,096 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Setting affinity for GPU 3 to ffff,ffffffff
2026-01-05 05:38:36,096 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO NVLS multicast support is not available on dev 3
2026-01-05 05:38:36,096 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO comm 0x32c81360 rank 3 nRanks 4 nNodes 1 localRanks 4 localRank 3 MNNVL 0
2026-01-05 05:38:36,296 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] -1/-1/-1->3->2
2026-01-05 05:38:36,296 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO P2P Chunksize set to 131072
2026-01-05 05:38:36,296 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:9160 [3] NCCL INFO [Proxy Service] Device 3 CPU core 25
2026-01-05 05:38:36,296 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:9165 [3] NCCL INFO [Proxy Service UDS] Device 3 CPU core 41
2026-01-05 05:38:36,297 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Channel 00 : 3[3] -> 0[0] via SHM/direct/direct
2026-01-05 05:38:36,297 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Channel 01 : 3[3] -> 0[0] via SHM/direct/direct
2026-01-05 05:38:36,297 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Bootstrap timings total 0.051068 (create 0.000035, send 0.000108, recv 0.000256, ring 0.000075, delay 0.000000)
2026-01-05 05:38:36,297 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Setting affinity for GPU 1 to ffff,ffffffff
2026-01-05 05:38:36,297 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO NVLS multicast support is not available on dev 1
2026-01-05 05:38:36,297 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO comm 0x2bfcb010 rank 2 nRanks 4 nNodes 1 localRanks 4 localRank 2 MNNVL 0
2026-01-05 05:38:36,297 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] 3/-1/-1->2->1
2026-01-05 05:38:36,297 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO P2P Chunksize set to 131072
2026-01-05 05:38:36,297 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:9162 [1] NCCL INFO [Proxy Service] Device 1 CPU core 0
2026-01-05 05:38:36,297 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:9166 [1] NCCL INFO [Proxy Service UDS] Device 1 CPU core 44
2026-01-05 05:38:36,297 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Channel 00 : 2[1] -> 3[3] via SHM/direct/direct
2026-01-05 05:38:36,297 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Channel 01 : 2[1] -> 3[3] via SHM/direct/direct
2026-01-05 05:38:36,297 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Using network Socket
2026-01-05 05:38:36,297 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO ncclCommInitRank comm 0x35b2a130 rank 1 nranks 4 cudaDev 2 nvmlDev 2 busId 3c000 commId 0x780d50bf49488d46 - Init START
2026-01-05 05:38:36,297 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Bootstrap timings total 0.000605 (create 0.000033, send 0.000139, recv 0.000196, ring 0.000086, delay 0.000000)
2026-01-05 05:38:36,297 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Setting affinity for GPU 2 to ffff,ffffffff
2026-01-05 05:38:36,297 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO NVLS multicast support is not available on dev 2
2026-01-05 05:38:36,297 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO comm 0x35b2a130 rank 1 nRanks 4 nNodes 1 localRanks 4 localRank 1 MNNVL 0
2026-01-05 05:38:36,297 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 2/-1/-1->1->0
2026-01-05 05:38:36,297 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO P2P Chunksize set to 131072
2026-01-05 05:38:36,297 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:9161 [2] NCCL INFO [Proxy Service] Device 2 CPU core 41
2026-01-05 05:38:36,297 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:9164 [2] NCCL INFO [Proxy Service UDS] Device 2 CPU core 25
2026-01-05 05:38:36,297 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Channel 00 : 1[2] -> 2[1] via SHM/direct/direct
2026-01-05 05:38:36,297 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Channel 01 : 1[2] -> 2[1] via SHM/direct/direct
2026-01-05 05:38:36,797 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m 2026-01-05 05:38:36,053	INFO torch_tensor_accelerator_channel.py:833 -- Communicator group initialized.
2026-01-05 05:38:36,797 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Channel 00 : 0[0] -> 1[2] via SHM/direct/direct
2026-01-05 05:38:36,797 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Channel 01 : 0[0] -> 1[2] via SHM/direct/direct
2026-01-05 05:38:36,798 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
2026-01-05 05:38:36,798 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Connected all trees
2026-01-05 05:38:36,798 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:9168 [0] NCCL INFO [Proxy Progress] Device 0 CPU core 33
2026-01-05 05:38:36,798 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
2026-01-05 05:38:36,798 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
2026-01-05 05:38:36,798 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO CC Off, workFifoBytes 1048576
2026-01-05 05:38:36,798 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO ncclCommInitRank comm 0x2ac57d40 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 38000 commId 0x780d50bf49488d46 - Init COMPLETE
2026-01-05 05:38:36,798 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:7462 [0] NCCL INFO Init timings - ncclCommInitRank: rank 0 nranks 4 total 0.29 (kernels 0.00, alloc 0.00, bootstrap 0.12, allgathers 0.00, topo 0.03, graphs 0.00, connections 0.12, rest 0.02)
2026-01-05 05:38:36,798 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
2026-01-05 05:38:36,798 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Channel 00 : 3[3] -> 2[1] via SHM/direct/direct
2026-01-05 05:38:36,798 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Channel 01 : 3[3] -> 2[1] via SHM/direct/direct
2026-01-05 05:38:36,798 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Connected all trees
2026-01-05 05:38:36,798 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:9169 [3] NCCL INFO [Proxy Progress] Device 3 CPU core 33
2026-01-05 05:38:36,798 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
2026-01-05 05:38:36,798 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
2026-01-05 05:38:36,798 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO ncclCommInitRank comm 0x32c81360 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId 3e000 commId 0x780d50bf49488d46 - Init COMPLETE
2026-01-05 05:38:36,798 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7465)[0m ip-172-31-43-142:7465:7465 [3] NCCL INFO Init timings - ncclCommInitRank: rank 3 nranks 4 total 0.22 (kernels 0.00, alloc 0.00, bootstrap 0.05, allgathers 0.00, topo 0.03, graphs 0.00, connections 0.12, rest 0.02)
2026-01-05 05:38:36,798 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
2026-01-05 05:38:36,798 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Channel 00 : 2[1] -> 1[2] via SHM/direct/direct
2026-01-05 05:38:36,798 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Channel 01 : 2[1] -> 1[2] via SHM/direct/direct
2026-01-05 05:38:36,798 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Connected all trees
2026-01-05 05:38:36,798 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:9171 [1] NCCL INFO [Proxy Progress] Device 1 CPU core 45
2026-01-05 05:38:36,798 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
2026-01-05 05:38:36,799 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
2026-01-05 05:38:36,799 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO ncclCommInitRank comm 0x2bfcb010 rank 2 nranks 4 cudaDev 1 nvmlDev 1 busId 3a000 commId 0x780d50bf49488d46 - Init COMPLETE
2026-01-05 05:38:36,799 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:7463 [1] NCCL INFO Init timings - ncclCommInitRank: rank 2 nranks 4 total 0.22 (kernels 0.00, alloc 0.00, bootstrap 0.05, allgathers 0.00, topo 0.03, graphs 0.00, connections 0.14, rest 0.00)
2026-01-05 05:38:36,799 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
2026-01-05 05:38:36,799 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Channel 00 : 1[2] -> 0[0] via SHM/direct/direct
2026-01-05 05:38:36,799 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Channel 01 : 1[2] -> 0[0] via SHM/direct/direct
2026-01-05 05:38:36,799 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Connected all trees
2026-01-05 05:38:36,799 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:9170 [2] NCCL INFO [Proxy Progress] Device 2 CPU core 33
2026-01-05 05:38:36,799 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
2026-01-05 05:38:36,799 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
2026-01-05 05:38:36,799 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO ncclCommInitRank comm 0x35b2a130 rank 1 nranks 4 cudaDev 2 nvmlDev 2 busId 3c000 commId 0x780d50bf49488d46 - Init COMPLETE
2026-01-05 05:38:36,799 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7464)[0m ip-172-31-43-142:7464:7464 [2] NCCL INFO Init timings - ncclCommInitRank: rank 1 nranks 4 total 0.17 (kernels 0.00, alloc 0.00, bootstrap 0.00, allgathers 0.00, topo 0.03, graphs 0.00, connections 0.12, rest 0.02)
2026-01-05 05:38:37,401 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:9179 [0] NCCL INFO Channel 00 : 0[0] -> 1[2] via SHM/direct/direct
2026-01-05 05:38:37,401 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7462)[0m ip-172-31-43-142:7462:9179 [0] NCCL INFO Channel 01 : 0[0] -> 1[2] via SHM/direct/direct
2026-01-05 05:38:37,402 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:9181 [1] NCCL INFO Channel 00 : 2[1] -> 3[3] via SHM/direct/direct
2026-01-05 05:38:37,402 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(RayWorkerWrapper pid=7463)[0m ip-172-31-43-142:7463:9181 [1] NCCL INFO Channel 01 : 2[1] -> 3[3] via SHM/direct/direct
2026-01-05 05:38:58,076 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [2026-01-05 05:38:57,937 E 7335 8970] core_worker_process.cc:842: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
2026-01-05 05:39:05,907 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m [36m(DAGDriverProxyActor pid=9103)[0m [2026-01-05 05:39:05,547 E 9103 9134] core_worker_process.cc:842: Failed to establish connection to the metrics exporter agent. Metrics will not be exported. Exporter agent status: RpcError: Running out of retries to initialize the metrics agent. rpc_code: 14
2026-01-05 05:39:44,538 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m
2026-01-05 05:39:44,538 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m Processed prompts:  20%|‚ñà‚ñà        | 1/5 [01:08<04:33, 68.34s/it, est. speed input: 29.98 toks/s, output: 7.46 toks/s]
2026-01-05 05:39:44,538 - INFO - Processed prompts: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 5/5 [01:09<00:00, 10.35s/it, est. speed input: 148.16 toks/s, output: 36.88 toks/s]
2026-01-05 05:39:44,538 - INFO - Processed prompts: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 5/5 [01:09<00:00, 10.35s/it, est. speed input: 148.16 toks/s, output: 36.88 toks/s]
2026-01-05 05:39:44,538 - INFO - Processed prompts: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 5/5 [01:09<00:00, 13.83s/it, est. speed input: 148.16 toks/s, output: 36.88 toks/s]
2026-01-05 05:39:45,242 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ‚úÖ Warmup complete, starting actual measurement
2026-01-05 05:39:45,242 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m üì° Found 1 Ray nodes for GPU monitoring
2026-01-05 05:40:14,838 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m    Placement group approach failed: Get timed out: some object(s) not ready.
2026-01-05 05:40:14,838 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m    Falling back to simple actor creation (no pinning)...
2026-01-05 05:40:14,838 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m   ‚úì Deployed monitor actor (will query node location)
2026-01-05 05:40:19,855 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m      Could not determine actor node: Get timed out: some object(s) not ready.
2026-01-05 05:40:19,855 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m    Starting monitoring on 1 nodes...
2026-01-05 05:40:19,856 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m    Starting monitor on node0...
2026-01-05 05:40:29,686 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m    ‚úó Failed to start monitor on node0: Get timed out: some object(s) not ready.
2026-01-05 05:40:29,686 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m Traceback (most recent call last):
2026-01-05 05:40:29,686 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m   File "/home/ubuntu/sky_workdir/roofline_benchmarks/benchmark_roofline-tp2-pp2-2048in-512out.py", line 224, in start
2026-01-05 05:40:29,686 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m     ray.get(future, timeout=10.0)  # 10 second timeout per actor
2026-01-05 05:40:29,686 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2026-01-05 05:40:29,687 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m   File "/home/ubuntu/sky_workdir/.venv/lib/python3.12/site-packages/ray/_private/auto_init_hook.py", line 22, in auto_init_wrapper
2026-01-05 05:40:29,687 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m     return fn(*args, **kwargs)
2026-01-05 05:40:29,687 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m            ^^^^^^^^^^^^^^^^^^^
2026-01-05 05:40:29,687 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m   File "/home/ubuntu/sky_workdir/.venv/lib/python3.12/site-packages/ray/_private/client_mode_hook.py", line 104, in wrapper
2026-01-05 05:40:29,687 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m     return func(*args, **kwargs)
2026-01-05 05:40:29,687 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m            ^^^^^^^^^^^^^^^^^^^^^
2026-01-05 05:40:29,687 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m   File "/home/ubuntu/sky_workdir/.venv/lib/python3.12/site-packages/ray/_private/worker.py", line 2967, in get
2026-01-05 05:40:29,687 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m     values, debugger_breakpoint = worker.get_objects(
2026-01-05 05:40:29,687 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m                                   ^^^^^^^^^^^^^^^^^^^
2026-01-05 05:40:29,687 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m   File "/home/ubuntu/sky_workdir/.venv/lib/python3.12/site-packages/ray/_private/worker.py", line 976, in get_objects
2026-01-05 05:40:29,687 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m     ] = self.core_worker.get_objects(
2026-01-05 05:40:29,687 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2026-01-05 05:40:29,687 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m   File "python/ray/_raylet.pyx", line 2875, in ray._raylet.CoreWorker.get_objects
2026-01-05 05:40:29,687 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m   File "python/ray/includes/common.pxi", line 101, in ray._raylet.check_status
2026-01-05 05:40:29,687 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ray.exceptions.GetTimeoutError: Get timed out: some object(s) not ready.
2026-01-05 05:40:29,687 - INFO - [36m(roofline-tp2-pp2-2048in-512out, pid=3246)[0m ‚ö†Ô∏è  Warning: No actors started successfully. Falling back to local monitoring.
2026-01-05 05:47:59,028 - INFO - üóëÔ∏è  Tearing down roofline-tp2-pp2-2048in-512out...
